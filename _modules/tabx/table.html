<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" />

    <!-- Generated with Sphinx 8.2.3 and Furo 2024.08.06 -->
        <title>tabx.table - tabx documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">tabx  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon no-toc" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  
  <span class="sidebar-brand-text">tabx  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../../README.html">tabx - compose LaTeX tables using booktabs in Python</a></li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../apidocs/index.html">API Reference</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of API Reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../apidocs/tabx/tabx.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tabx</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of tabx</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../apidocs/tabx/tabx.utils.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tabx.utils</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../apidocs/tabx/tabx.custom.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tabx.custom</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../apidocs/tabx/tabx.table.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tabx.table</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon no-toc" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <h1>Source code for tabx.table</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span><span class="w"> </span><span class="nn">__future__</span><span class="w"> </span><span class="kn">import</span> <span class="n">annotations</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">dataclasses</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">dc</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">itertools</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">it</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">operator</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">abc</span><span class="w"> </span><span class="kn">import</span> <span class="n">ABC</span><span class="p">,</span> <span class="n">abstractmethod</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">abc</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">collections.abc</span><span class="w"> </span><span class="kn">import</span> <span class="n">Sequence</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">copy</span><span class="w"> </span><span class="kn">import</span> <span class="n">deepcopy</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">functools</span><span class="w"> </span><span class="kn">import</span> <span class="n">reduce</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">itertools</span><span class="w"> </span><span class="kn">import</span> <span class="n">chain</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">Any</span><span class="p">,</span>
    <span class="n">Callable</span><span class="p">,</span>
    <span class="n">Iterable</span><span class="p">,</span>
    <span class="n">Literal</span><span class="p">,</span>
    <span class="n">Self</span><span class="p">,</span>
    <span class="n">TypeVar</span><span class="p">,</span>
    <span class="n">assert_never</span><span class="p">,</span>
    <span class="n">cast</span><span class="p">,</span>
    <span class="n">overload</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;Cmidrule&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Cmidrules&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Columns&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ColoredRow&quot;</span><span class="p">,</span>
    <span class="s2">&quot;empty_columns&quot;</span><span class="p">,</span>
    <span class="s2">&quot;empty_cell&quot;</span><span class="p">,</span>
    <span class="s2">&quot;empty_cells&quot;</span><span class="p">,</span>
    <span class="s2">&quot;empty_table&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Cell&quot;</span><span class="p">,</span>
    <span class="s2">&quot;filled_columns&quot;</span><span class="p">,</span>
    <span class="s2">&quot;filled_table&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Midrule&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Toprule&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Bottomrule&quot;</span><span class="p">,</span>
    <span class="s2">&quot;multirow_column&quot;</span><span class="p">,</span>
    <span class="s2">&quot;multicolumn_row&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Row&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Rule&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Table&quot;</span><span class="p">,</span>
    <span class="s2">&quot;concat&quot;</span><span class="p">,</span>
<span class="p">]</span>

<span class="c1"># type alias notation &gt;= 3.12</span>
<span class="nb">type</span> <span class="n">TableRow</span> <span class="o">=</span> <span class="n">Row</span> <span class="o">|</span> <span class="n">Cmidrule</span> <span class="o">|</span> <span class="n">Cmidrules</span> <span class="o">|</span> <span class="n">Rule</span>
<span class="nb">type</span> <span class="n">NumOrStr</span> <span class="o">=</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">str</span>


<div class="viewcode-block" id="Cell">
<a class="viewcode-back" href="../../apidocs/tabx/tabx.table.html#tabx.table.Cell">[docs]</a>
<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Cell</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A cell in a table with optional formatting and spanning behavior.</span>

<span class="sd">    Represents a single value in a table, optionally spanning multiple columns</span>
<span class="sd">    or rows, and supporting LaTeX-style rendering (e.g., math mode, bold,</span>
<span class="sd">                                                   italic).</span>

<span class="sd">    ### Attributes</span>

<span class="sd">    :value: The displayed value in the table cell.</span>
<span class="sd">    - name: An optional identifier or key for the cell (used internally).</span>
<span class="sd">    - `style`: Text style for LaTeX rendering: &#39;math&#39;, &#39;bold&#39;, &#39;italic&#39;, or</span>
<span class="sd">    &#39;none&#39;.</span>
<span class="sd">    - `multicolumn`: Number of columns this cell spans.</span>
<span class="sd">    - `colspec`: Alignment of multicolumn text (&#39;l&#39;, &#39;c&#39;, or &#39;r&#39;).</span>
<span class="sd">    - `multirow`: Number of rows this cell spans.</span>
<span class="sd">    - `width`: Width specification for multirow cells (LaTeX syntax, e.g.,</span>
<span class="sd">                                                     &#39;*&#39;, &#39;2cm&#39;).</span>

<span class="sd">    Raises:</span>
<span class="sd">    - ValueError: If both multicolumn and multirow are greater than 1.</span>


<span class="sd">    {lineno-start=1 emphasize-lines=&quot;2,3&quot;}</span>
<span class="sd">    ```python</span>
<span class="sd">    from tabx import Cell</span>
<span class="sd">    print(Cell(&quot;1&quot;))</span>
<span class="sd">    print(Cell(&quot;1&quot;))</span>
<span class="sd">    print(Cell(&quot;1&quot;))</span>
<span class="sd">    print(Cell(&quot;1&quot;))</span>
<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">value</span><span class="p">:</span> <span class="n">NumOrStr</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">field</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">init</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="nb">repr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;help&quot;</span><span class="p">:</span> <span class="s2">&quot;The name of the cell, used for identification.&quot;</span><span class="p">},</span>
    <span class="p">)</span>
    <span class="n">style</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;math&quot;</span><span class="p">,</span> <span class="s2">&quot;bold&quot;</span><span class="p">,</span> <span class="s2">&quot;italic&quot;</span><span class="p">,</span> <span class="s2">&quot;none&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span>
    <span class="n">multicolumn</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">colspec</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;l&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;c&quot;</span>
    <span class="n">multirow</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">vpos</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>  <span class="c1"># vertical position for multirow</span>
    <span class="n">vmove</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>  <span class="c1"># vertical move for multirow</span>
    <span class="n">width</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;*&quot;</span>  <span class="c1"># for multirow width (&quot;*&quot;, &quot;2cm&quot;, etc.)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;Cell(name=&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&quot;, value=&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s1">&quot;, multirow=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">multirow</span><span class="si">}</span><span class="s1">, multicolumn=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">multicolumn</span><span class="si">}</span><span class="s1">)&#39;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;Cell(value=&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s1">&quot;, multirow=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">multirow</span><span class="si">}</span><span class="s1">, multicolumn=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">multicolumn</span><span class="si">}</span><span class="s1">)&#39;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">multicolumn</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot have multicolumn &lt;= 0&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">multirow</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot have multirow &lt;= 0&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">multicolumn</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">multirow</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Cell cannot be both multicolumn and multirow at the same time.&quot;</span>
            <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">multicolumn</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">multicolumn</span>
        <span class="k">return</span> <span class="mi">1</span>

<div class="viewcode-block" id="Cell.clen">
<a class="viewcode-back" href="../../apidocs/tabx/tabx.table.html#tabx.table.Cell.clen">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">clen</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the number of rows in a column this cell occupies.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">multirow</span></div>


<div class="viewcode-block" id="Cell.is_multirow">
<a class="viewcode-back" href="../../apidocs/tabx/tabx.table.html#tabx.table.Cell.is_multirow">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_multirow</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return True if this cell is a multirow cell.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">multirow</span> <span class="o">&gt;</span> <span class="mi">1</span></div>


<div class="viewcode-block" id="Cell.is_multicolumn">
<a class="viewcode-back" href="../../apidocs/tabx/tabx.table.html#tabx.table.Cell.is_multicolumn">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_multicolumn</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return True if this cell is a multicolumn cell.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">multicolumn</span> <span class="o">&gt;</span> <span class="mi">1</span></div>


<div class="viewcode-block" id="Cell.is_empty">
<a class="viewcode-back" href="../../apidocs/tabx/tabx.table.html#tabx.table.Cell.is_empty">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_empty</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return True if this cell is empty.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span></div>


<div class="viewcode-block" id="Cell.render">
<a class="viewcode-back" href="../../apidocs/tabx/tabx.table.html#tabx.table.Cell.render">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

        <span class="k">match</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="p">:</span>
            <span class="k">case</span> <span class="s2">&quot;math&quot;</span><span class="p">:</span>
                <span class="n">text</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;$&quot;</span> <span class="o">+</span> <span class="n">text</span> <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot;$&quot;</span>
            <span class="k">case</span> <span class="s2">&quot;bold&quot;</span><span class="p">:</span>
                <span class="n">text</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;\textbf{&quot;</span> <span class="o">+</span> <span class="n">text</span> <span class="o">+</span> <span class="s2">&quot;}&quot;</span>
            <span class="k">case</span> <span class="s2">&quot;italic&quot;</span><span class="p">:</span>
                <span class="n">text</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;\textit{&quot;</span> <span class="o">+</span> <span class="n">text</span> <span class="o">+</span> <span class="s2">&quot;}&quot;</span>
            <span class="k">case</span> <span class="s2">&quot;none&quot;</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown style: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Apply multicolumn</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">multicolumn</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">=</span> <span class="p">(</span>
                <span class="sa">r</span><span class="s2">&quot;\multicolumn{&quot;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">multicolumn</span><span class="p">)</span>
                <span class="o">+</span> <span class="s2">&quot;}{&quot;</span>
                <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">colspec</span>
                <span class="o">+</span> <span class="s2">&quot;}{&quot;</span>
                <span class="o">+</span> <span class="n">text</span>
                <span class="o">+</span> <span class="s2">&quot;}&quot;</span>
            <span class="p">)</span>

        <span class="c1"># Apply multirow</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">multirow</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># \\multirow[〈vpos〉]{〈nrows〉}{〈width〉}[〈vmove〉]{〈text〉}</span>
            <span class="n">parts</span> <span class="o">=</span> <span class="p">[</span>
                <span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">vpos</span><span class="si">}</span><span class="s2">]&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vpos</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="se">{{</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">multirow</span><span class="p">)</span><span class="si">}</span><span class="se">}}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="se">{{</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="si">}</span><span class="se">}}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">vmove</span><span class="si">}</span><span class="s2">]&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vmove</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="se">{{</span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="se">}}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="p">]</span>
            <span class="n">text</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;\multirow&quot;</span> <span class="o">+</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">text</span></div>


    <span class="k">def</span><span class="w"> </span><span class="fm">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="p">(</span><span class="n">Table</span><span class="p">,</span> <span class="n">Columns</span><span class="p">)):</span>
            <span class="k">return</span> <span class="n">other</span><span class="o">.</span><span class="n">prepend_row</span><span class="p">(</span><span class="n">Row</span><span class="p">([</span><span class="bp">self</span><span class="p">]))</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Cell</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">Table</span><span class="p">([</span><span class="n">Row</span><span class="p">([</span><span class="bp">self</span><span class="p">]),</span> <span class="n">Row</span><span class="p">([</span><span class="n">other</span><span class="p">])])</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="p">(</span><span class="n">Cmidrule</span><span class="p">,</span> <span class="n">Cmidrules</span><span class="p">,</span> <span class="n">Midrule</span><span class="p">)):</span>
            <span class="k">return</span> <span class="n">Table</span><span class="p">([</span><span class="n">Row</span><span class="p">([</span><span class="bp">self</span><span class="p">]),</span> <span class="n">other</span><span class="p">])</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;unsupported operand type(s) for /: &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;and &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
        <span class="p">)</span>

    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__or__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Row</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Row</span><span class="p">:</span> <span class="o">...</span>
    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__or__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Cell</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span> <span class="o">...</span>

    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__or__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Cell</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span> <span class="o">...</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__or__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="p">(</span><span class="n">Cmidrule</span><span class="p">,</span> <span class="n">Cmidrules</span><span class="p">,</span> <span class="n">Midrule</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;unsupported operand type(s) for |: &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;and &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Table</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">Columns</span><span class="p">([</span><span class="n">Row</span><span class="p">([</span><span class="bp">self</span><span class="p">])])</span> <span class="o">|</span> <span class="n">other</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Columns</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">Table</span><span class="o">.</span><span class="n">from_columns</span><span class="p">(</span><span class="n">Columns</span><span class="p">([</span><span class="n">Row</span><span class="p">([</span><span class="bp">self</span><span class="p">])]))</span> <span class="o">|</span> <span class="n">other</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Cell</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">Table</span><span class="p">([</span><span class="n">Row</span><span class="p">([</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">])])</span>
        <span class="k">if</span> <span class="n">match_seq</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="n">Cell</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;seq&quot;</span><span class="p">:</span>
            <span class="n">other</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="nb">list</span><span class="p">[</span><span class="n">Cell</span><span class="p">],</span> <span class="n">other</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">Table</span><span class="p">([</span><span class="n">Row</span><span class="p">([</span><span class="bp">self</span><span class="p">])])</span> <span class="o">|</span> <span class="n">Table</span><span class="p">([</span><span class="n">Row</span><span class="p">(</span><span class="n">other</span><span class="p">)])</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Row</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">Row</span><span class="p">([</span><span class="bp">self</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">cells</span><span class="p">))</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;unsupported operand type(s) for |: &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;and &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
        <span class="p">)</span></div>



<span class="k">class</span><span class="w"> </span><span class="nc">ColoredCell</span><span class="p">(</span><span class="n">Cell</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A colored `Cell`.</span>

<span class="sd">    Requires the `xcolor` package in LaTeX.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">color</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">multicolumn</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">multirow</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">,</span> <span class="n">multicolumn</span><span class="o">=</span><span class="n">multicolumn</span><span class="p">,</span> <span class="n">multirow</span><span class="o">=</span><span class="n">multirow</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">color</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;ColoredCell(name=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">, color=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">color</span><span class="si">}</span><span class="s2">)&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;ColoredCell(color=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">color</span><span class="si">}</span><span class="s2">)&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">r</span><span class="s2">&quot;\cellcolor{&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">color</span> <span class="o">+</span> <span class="s2">&quot;}&quot;</span> <span class="o">+</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>


<span class="k">class</span><span class="w"> </span><span class="nc">EmptyCell</span><span class="p">(</span><span class="n">Cell</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">multicolumn</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">multirow</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;EmptyCell(name=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">)&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;EmptyCell()&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span>


<span class="k">class</span><span class="w"> </span><span class="nc">Placeholder</span><span class="p">(</span><span class="n">Cell</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">multicolumn</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">multirow</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;PlaceholderCell(name=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">)&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span>


<span class="k">class</span><span class="w"> </span><span class="nc">MrEmptyCell</span><span class="p">(</span><span class="n">Cell</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">mr</span><span class="p">:</span> <span class="n">MultirowCell</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">multicolumn</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">multirow</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mr</span> <span class="o">=</span> <span class="n">mr</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;MrEmptyCell(name=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">)&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;MrEmptyCell()&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">link</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mr</span><span class="p">:</span> <span class="n">MultirowCell</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mr</span> <span class="o">=</span> <span class="n">mr</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">unlink</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mr</span><span class="p">,</span> <span class="n">MultirowCell</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot unlink unlinked MrEmptyCell&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mr</span><span class="o">.</span><span class="n">decrease</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mr</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span>


<span class="k">class</span><span class="w"> </span><span class="nc">MultirowCell</span><span class="p">(</span><span class="n">Cell</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">value</span><span class="p">:</span> <span class="n">NumOrStr</span><span class="p">,</span>
        <span class="n">multirow</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">vpos</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span>
        <span class="n">vmove</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">width</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">style</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;math&quot;</span><span class="p">,</span> <span class="s2">&quot;bold&quot;</span><span class="p">,</span> <span class="s2">&quot;italic&quot;</span><span class="p">,</span> <span class="s2">&quot;none&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
            <span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">,</span>
            <span class="n">multirow</span><span class="o">=</span><span class="n">multirow</span><span class="p">,</span>
            <span class="n">vpos</span><span class="o">=</span><span class="n">vpos</span><span class="p">,</span>
            <span class="n">vmove</span><span class="o">=</span><span class="n">vmove</span><span class="p">,</span>
            <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span>
            <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">empty_cells</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_cell</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">cell</span><span class="p">:</span> <span class="n">Cell</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="n">cell</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="n">value</span><span class="o">=</span><span class="n">cell</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
            <span class="n">multirow</span><span class="o">=</span><span class="n">cell</span><span class="o">.</span><span class="n">multirow</span><span class="p">,</span>
            <span class="n">vpos</span><span class="o">=</span><span class="n">cell</span><span class="o">.</span><span class="n">vpos</span><span class="p">,</span>
            <span class="n">vmove</span><span class="o">=</span><span class="n">cell</span><span class="o">.</span><span class="n">vmove</span><span class="p">,</span>
            <span class="n">width</span><span class="o">=</span><span class="n">cell</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
            <span class="n">style</span><span class="o">=</span><span class="n">cell</span><span class="o">.</span><span class="n">style</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;MultirowCell(name=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">, value=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">, multirow=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">multirow</span><span class="si">}</span><span class="s2">)&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_empty_cell</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">empty_cell</span><span class="p">:</span> <span class="n">MrEmptyCell</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">empty_cells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">empty_cell</span><span class="p">)</span>
        <span class="n">empty_cell</span><span class="o">.</span><span class="n">link</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">decrease</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">multirow</span> <span class="o">-=</span> <span class="mi">1</span>

    <span class="c1"># Hashing into dict based on id of object but equality just based on</span>
    <span class="c1"># values of attributes.</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">MultirowCell</span><span class="p">)</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">name</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">value</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">multirow</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">multirow</span>
        <span class="p">)</span>


<div class="viewcode-block" id="multirow_column">
<a class="viewcode-back" href="../../apidocs/tabx/tabx.table.html#tabx.table.multirow_column">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">multirow_column</span><span class="p">(</span>
    <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">multirow</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">vpos</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">vmove</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">width</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;*&quot;</span><span class="p">,</span>
    <span class="n">style</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;math&quot;</span><span class="p">,</span> <span class="s2">&quot;bold&quot;</span><span class="p">,</span> <span class="s2">&quot;italic&quot;</span><span class="p">,</span> <span class="s2">&quot;none&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span>
    <span class="n">pad_before</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">pad_after</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">align</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Columns</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a column with a multirow cell and empty cells.&quot;&quot;&quot;</span>
    <span class="n">mrf</span> <span class="o">=</span> <span class="n">MultirowCell</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
        <span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">,</span>
        <span class="n">multirow</span><span class="o">=</span><span class="n">multirow</span><span class="p">,</span>
        <span class="n">vpos</span><span class="o">=</span><span class="n">vpos</span><span class="p">,</span>
        <span class="n">vmove</span><span class="o">=</span><span class="n">vmove</span><span class="p">,</span>
        <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span>
        <span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ecells</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">multirow</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">MrEmptyCell</span><span class="p">()</span>
        <span class="n">mrf</span><span class="o">.</span><span class="n">add_empty_cell</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="n">ecells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="n">col</span> <span class="o">=</span> <span class="n">Columns</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="p">[</span><span class="n">Row</span><span class="p">([</span><span class="n">mrf</span><span class="p">])]</span> <span class="o">+</span> <span class="p">[</span><span class="n">Row</span><span class="p">([</span><span class="n">f</span><span class="p">])</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">ecells</span><span class="p">],</span> <span class="n">align</span><span class="o">=</span><span class="n">align</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">pad_before</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">empty_columns</span><span class="p">(</span><span class="n">pad_before</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">col</span>
    <span class="k">if</span> <span class="n">pad_after</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">col</span> <span class="o">/</span> <span class="n">empty_columns</span><span class="p">(</span><span class="n">pad_after</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">col</span></div>



<div class="viewcode-block" id="multicolumn_row">
<a class="viewcode-back" href="../../apidocs/tabx/tabx.table.html#tabx.table.multicolumn_row">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">multicolumn_row</span><span class="p">(</span>
    <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">multicolumn</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">colspec</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;l&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span>
    <span class="n">pad_before</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">pad_after</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Row</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a row with a multicolumn cell and empty cells.&quot;&quot;&quot;</span>
    <span class="n">cell</span> <span class="o">=</span> <span class="n">Cell</span><span class="p">(</span>
        <span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">,</span>
        <span class="n">multicolumn</span><span class="o">=</span><span class="n">multicolumn</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
        <span class="n">colspec</span><span class="o">=</span><span class="n">colspec</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">Row</span><span class="p">(</span><span class="n">empty_cells</span><span class="p">(</span><span class="n">pad_before</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="n">cell</span><span class="p">]</span> <span class="o">+</span> <span class="n">empty_cells</span><span class="p">(</span><span class="n">pad_after</span><span class="p">))</span></div>



<span class="k">def</span><span class="w"> </span><span class="nf">slice_range_cmidrule</span><span class="p">(</span><span class="n">index</span><span class="p">:</span> <span class="nb">slice</span><span class="p">,</span> <span class="n">cm</span><span class="p">:</span> <span class="n">Cmidrule</span><span class="p">):</span>
    <span class="n">idx_start</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Full interval</span>
    <span class="n">idx_stop</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">stop</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">index</span><span class="o">.</span><span class="n">stop</span><span class="p">:</span>
        <span class="n">idx_stop</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">end</span>
    <span class="k">return</span> <span class="nb">range</span><span class="p">(</span><span class="n">idx_start</span><span class="p">,</span> <span class="n">idx_stop</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">range_to_interval</span><span class="p">(</span><span class="n">r</span><span class="p">:</span> <span class="nb">range</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="n">r</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>


<div class="viewcode-block" id="Cmidrule">
<a class="viewcode-back" href="../../apidocs/tabx/tabx.table.html#tabx.table.Cmidrule">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Cmidrule</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A LaTeX cmidrule.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">start</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">end</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">trim</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;lr&quot;</span><span class="p">,</span>
        <span class="n">dim</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="k">if</span> <span class="n">start</span> <span class="o">&gt;</span> <span class="n">end</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Start (</span><span class="si">{</span><span class="n">start</span><span class="si">}</span><span class="s2">) must be less than end (</span><span class="si">{</span><span class="n">end</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">start</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">end</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Start (</span><span class="si">{</span><span class="n">start</span><span class="si">}</span><span class="s2">) and end (</span><span class="si">{</span><span class="n">end</span><span class="si">}</span><span class="s2">) must be &gt;= 1&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">start</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">end</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trim</span> <span class="o">=</span> <span class="n">trim</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rule</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;\cmidrule&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">=</span> <span class="n">dim</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Cmidrule(start=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="si">}</span><span class="s2">, end=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="si">}</span><span class="s2">, lr=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">trim</span><span class="si">}</span><span class="s2">)&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Cmidrule</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">()</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">trim</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">end</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">trim</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">interval</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Cmidrules are 1-indexed in latex and right-inclusive.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">interval_range</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">range</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">range</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">interval</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">slice</span><span class="p">,</span>
        <span class="n">standardize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Cmidrule</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Cmidrules are 1-indexed in latex and right-inclusive.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">interval</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">interval</span>
        <span class="n">interval_range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">interval_range</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">index</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">interval_range</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Index </span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s2"> out of bounds for </span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s2"> with </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">interval_range</span><span class="si">=}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
            <span class="k">return</span> <span class="n">Cmidrule</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">trim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">trim</span><span class="p">)</span>

        <span class="n">slice_range</span> <span class="o">=</span> <span class="n">slice_range_cmidrule</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>

        <span class="c1"># slice</span>
        <span class="n">slice_idc</span> <span class="o">=</span> <span class="n">slice_range</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">slice_idc</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Index out of range: </span><span class="si">{</span><span class="n">slice_range</span><span class="si">=}</span><span class="s2">; </span><span class="si">{</span><span class="n">index</span><span class="si">=}</span><span class="s2">; </span><span class="si">{</span><span class="n">slice_idc</span><span class="si">=}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="n">start_slice</span><span class="p">,</span> <span class="n">end_slice</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">slice_idc</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">slice_idc</span><span class="p">)</span>
        <span class="n">interval_slice</span> <span class="o">=</span> <span class="p">(</span><span class="n">start_slice</span><span class="p">,</span> <span class="n">end_slice</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">cond</span> <span class="o">=</span> <span class="n">interval_conditions</span><span class="p">(</span><span class="n">interval</span><span class="p">,</span> <span class="n">interval_slice</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">standardize</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">standardize</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="n">std_base</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">start_slice</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">standardize</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">standardize</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">std_base</span> <span class="o">=</span> <span class="n">standardize</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">std_base</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">match</span> <span class="n">cond</span><span class="o">.</span><span class="n">condition</span><span class="p">:</span>
            <span class="k">case</span> <span class="s2">&quot;center&quot;</span> <span class="o">|</span> <span class="s2">&quot;left&quot;</span> <span class="o">|</span> <span class="s2">&quot;right&quot;</span><span class="p">:</span>
                <span class="n">start</span> <span class="o">=</span> <span class="n">cond</span><span class="o">.</span><span class="n">start</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="n">end</span> <span class="o">=</span> <span class="n">cond</span><span class="o">.</span><span class="n">end</span>
                <span class="k">if</span> <span class="n">standardize</span><span class="p">:</span>
                    <span class="n">start</span> <span class="o">-=</span> <span class="n">std_base</span>
                    <span class="n">end</span> <span class="o">-=</span> <span class="n">std_base</span>
                <span class="k">return</span> <span class="n">Cmidrule</span><span class="p">(</span>
                    <span class="c1"># add one to convert back to 1-index</span>
                    <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">,</span>
                    <span class="n">end</span><span class="o">=</span><span class="n">end</span><span class="p">,</span>
                    <span class="n">trim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">trim</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">case</span> <span class="s2">&quot;none&quot;</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Index out of range; overlap=&#39;none&#39;; &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">interval</span><span class="si">=}</span><span class="s2">; </span><span class="si">{</span><span class="n">slice_range</span><span class="si">=}</span><span class="s2">; </span><span class="si">{</span><span class="n">index</span><span class="si">=}</span><span class="s2">; </span><span class="si">{</span><span class="n">slice_idc</span><span class="si">=}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Cmidrule</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add an offset to a Cmidrule, returning a new Cmidrule.</span>
<span class="sd">        Supports:</span>
<span class="sd">          - int: shifts both start and end by the same amount</span>
<span class="sd">          - tuple[int, int]: shifts start and end independently</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">start</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">+</span> <span class="n">other</span>
            <span class="n">end</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span> <span class="o">+</span> <span class="n">other</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">dstart</span><span class="p">,</span> <span class="n">dend</span> <span class="o">=</span> <span class="n">other</span>
            <span class="n">start</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">+</span> <span class="n">dstart</span>
            <span class="n">end</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span> <span class="o">+</span> <span class="n">dend</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unsupported type: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">start</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">end</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Out of bounds </span><span class="si">{</span><span class="n">start</span><span class="si">=}</span><span class="s2">, </span><span class="si">{</span><span class="n">end</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Cmidrule</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">end</span><span class="p">,</span> <span class="n">trim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">trim</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Cmidrule</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adding two Cmidrules should result in a Cmidrules object.</span>

<span class="sd">        We shouldn&#39;t return a Cmidrule object because often we have.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="n">other</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">dstart</span><span class="p">,</span> <span class="n">dend</span> <span class="o">=</span> <span class="n">other</span>
            <span class="k">return</span> <span class="bp">self</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="n">dstart</span><span class="p">,</span> <span class="o">-</span><span class="n">dend</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__or__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Cmidrule</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">overlap</span> <span class="o">:=</span> <span class="p">(</span>
                <span class="nb">set</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
                <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">end</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
            <span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cmidrules overlap: </span><span class="si">{</span><span class="n">overlap</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">start</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">Cmidrules</span><span class="p">([</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">])</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">&gt;</span> <span class="n">other</span><span class="o">.</span><span class="n">end</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">Cmidrules</span><span class="p">([</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Cmidrules</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">Cmidrules</span><span class="p">([</span><span class="bp">self</span><span class="p">]</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;unsupported operand type(s) for |: &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;and &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
        <span class="p">)</span>

    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Table</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span> <span class="o">...</span>

    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span> <span class="o">...</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="p">(</span><span class="n">Table</span><span class="p">,</span> <span class="n">Columns</span><span class="p">)):</span>
            <span class="k">return</span> <span class="n">other</span><span class="o">.</span><span class="n">prepend_row</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Cell</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">Table</span><span class="p">([</span><span class="bp">self</span><span class="p">,</span> <span class="n">Row</span><span class="p">([</span><span class="n">other</span><span class="p">])])</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="p">(</span><span class="n">Cmidrule</span><span class="p">,</span> <span class="n">Cmidrules</span><span class="p">,</span> <span class="n">Midrule</span><span class="p">)):</span>
            <span class="k">return</span> <span class="n">Table</span><span class="p">([</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">])</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">1</span>

<div class="viewcode-block" id="Cmidrule.clen">
<a class="viewcode-back" href="../../apidocs/tabx/tabx.table.html#tabx.table.Cmidrule.clen">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">clen</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">+</span> <span class="mi">1</span></div>


<div class="viewcode-block" id="Cmidrule.rlen">
<a class="viewcode-back" href="../../apidocs/tabx/tabx.table.html#tabx.table.Cmidrule.rlen">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">rlen</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span></div>


<div class="viewcode-block" id="Cmidrule.dlen">
<a class="viewcode-back" href="../../apidocs/tabx/tabx.table.html#tabx.table.Cmidrule.dlen">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">dlen</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span></div>


<div class="viewcode-block" id="Cmidrule.render_base">
<a class="viewcode-back" href="../../apidocs/tabx/tabx.table.html#tabx.table.Cmidrule.render_base">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">render_base</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">trim</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">rule</span><span class="si">}</span><span class="s2">[</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dim</span><span class="si">}</span><span class="s2">](</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">trim</span><span class="si">}</span><span class="s2">)</span><span class="se">{{</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="si">}</span><span class="se">}}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">trim</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">rule</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">trim</span><span class="si">}</span><span class="s2">)</span><span class="se">{{</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="si">}</span><span class="se">}}</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">rule</span><span class="si">}</span><span class="se">{{</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="si">}</span><span class="se">}}</span><span class="s2">&quot;</span></div>


<div class="viewcode-block" id="Cmidrule.render">
<a class="viewcode-back" href="../../apidocs/tabx/tabx.table.html#tabx.table.Cmidrule.render">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Cmidrule doesn&#39;t need a latex newline `\\`&quot;&quot;&quot;</span>
        <span class="n">base</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">render_base</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">base</span></div>
</div>



<div class="viewcode-block" id="Cmidrules">
<a class="viewcode-back" href="../../apidocs/tabx/tabx.table.html#tabx.table.Cmidrules">[docs]</a>
<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Cmidrules</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A collection of Cmidrules.&quot;&quot;&quot;</span>

    <span class="n">values</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Cmidrule</span><span class="p">]</span>

    <span class="n">start</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">end</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Cmidrules(#cmidrules=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">cmidrule</span><span class="o">.</span><span class="n">clen</span><span class="p">()</span> <span class="k">for</span> <span class="n">cmidrule</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

<div class="viewcode-block" id="Cmidrules.render">
<a class="viewcode-back" href="../../apidocs/tabx/tabx.table.html#tabx.table.Cmidrules.render">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cmidrule</span><span class="o">.</span><span class="n">render_base</span><span class="p">()</span> <span class="k">for</span> <span class="n">cmidrule</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span></div>


    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># check overlap</span>
        <span class="k">for</span> <span class="n">cm1</span><span class="p">,</span> <span class="n">cm2</span> <span class="ow">in</span> <span class="n">it</span><span class="o">.</span><span class="n">combinations</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
            <span class="n">cond</span> <span class="o">=</span> <span class="n">interval_conditions</span><span class="p">(</span><span class="n">cm1</span><span class="o">.</span><span class="n">interval</span><span class="p">,</span> <span class="n">cm2</span><span class="o">.</span><span class="n">interval</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">cond</span><span class="o">.</span><span class="n">condition</span> <span class="o">==</span> <span class="s2">&quot;none&quot;</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cmidrules </span><span class="si">{</span><span class="n">cm1</span><span class="si">=}</span><span class="s2"> and </span><span class="si">{</span><span class="n">cm2</span><span class="si">=}</span><span class="s2"> overlap.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>  <span class="c1"># Else empty cmidrule</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">operator</span><span class="o">.</span><span class="n">attrgetter</span><span class="p">(</span><span class="s2">&quot;start&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">start</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">end</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">operator</span><span class="o">.</span><span class="n">attrgetter</span><span class="p">(</span><span class="s2">&quot;end&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">end</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">operator</span><span class="o">.</span><span class="n">attrgetter</span><span class="p">(</span><span class="s2">&quot;start&quot;</span><span class="p">))</span>

<div class="viewcode-block" id="Cmidrules.clen">
<a class="viewcode-back" href="../../apidocs/tabx/tabx.table.html#tabx.table.Cmidrules.clen">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">clen</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="n">max_end</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">operator</span><span class="o">.</span><span class="n">attrgetter</span><span class="p">(</span><span class="s2">&quot;end&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">end</span>
        <span class="n">min_start</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">operator</span><span class="o">.</span><span class="n">attrgetter</span><span class="p">(</span><span class="s2">&quot;start&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">start</span>
        <span class="k">return</span> <span class="n">max_end</span> <span class="o">-</span> <span class="n">min_start</span> <span class="o">+</span> <span class="mi">1</span></div>


    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">slice</span><span class="p">,</span>
        <span class="n">standardize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Cmidrules</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Cmidrules are 1-indexed in latex</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">index</span> <span class="o">=</span> <span class="n">standardize_index</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>

        <span class="n">cmids</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">cmidrule</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">cmids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cmidrule</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">standardize</span><span class="o">=</span><span class="n">standardize</span><span class="p">))</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">IndexError</span><span class="p">):</span>
                <span class="k">pass</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">cmids</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">Cmidrules</span><span class="p">([])</span>
        <span class="k">return</span> <span class="n">Cmidrules</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="n">cmids</span><span class="p">)</span>

<div class="viewcode-block" id="Cmidrules.print">
<a class="viewcode-back" href="../../apidocs/tabx/tabx.table.html#tabx.table.Cmidrules.print">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">print</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">])</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span></div>


    <span class="k">def</span><span class="w"> </span><span class="fm">__or__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Cmidrule</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">Cmidrules</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">+</span> <span class="p">[</span><span class="n">other</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Cmidrules</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">Cmidrules</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;unsupported operand type(s) for |: &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;and &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
        <span class="p">)</span>

    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Table</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span> <span class="o">...</span>

    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span> <span class="o">...</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="p">(</span><span class="n">Table</span><span class="p">,</span> <span class="n">Columns</span><span class="p">)):</span>
            <span class="k">return</span> <span class="n">other</span><span class="o">.</span><span class="n">prepend_row</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Cell</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">Table</span><span class="p">([</span><span class="bp">self</span><span class="p">,</span> <span class="n">Row</span><span class="p">([</span><span class="n">other</span><span class="p">])])</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="p">(</span><span class="n">Cmidrule</span><span class="p">,</span> <span class="n">Cmidrules</span><span class="p">,</span> <span class="n">Midrule</span><span class="p">)):</span>
            <span class="k">return</span> <span class="n">Table</span><span class="p">([</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">])</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;unsupported operand type(s) for /: &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;and &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
        <span class="p">)</span></div>



<div class="viewcode-block" id="Rule">
<a class="viewcode-back" href="../../apidocs/tabx/tabx.table.html#tabx.table.Rule">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Rule</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class rules.&quot;&quot;&quot;</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">1</span>

<div class="viewcode-block" id="Rule.clen">
<a class="viewcode-back" href="../../apidocs/tabx/tabx.table.html#tabx.table.Rule.clen">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">clen</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        If Midrule only element in rows then it is 1 column.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mi">1</span></div>


<div class="viewcode-block" id="Rule.render">
<a class="viewcode-back" href="../../apidocs/tabx/tabx.table.html#tabx.table.Rule.render">[docs]</a>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the LaTeX code representation of the rule.</span>
<span class="sd">        Must be implemented by subclasses.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span></div>


    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Table</span> <span class="o">|</span> <span class="n">Columns</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Cell</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">Columns</span><span class="p">([</span><span class="bp">self</span><span class="p">,</span> <span class="n">Row</span><span class="p">([</span><span class="n">other</span><span class="p">])])</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="p">(</span><span class="n">Table</span><span class="p">,</span> <span class="n">Columns</span><span class="p">)):</span>
            <span class="k">return</span> <span class="n">other</span><span class="o">.</span><span class="n">prepend_row</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Rule</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="s2">&quot;Recall wisdom from booktabs docs: &#39;2. Never use double rules.&#39;&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;Got &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">()</span></div>



<div class="viewcode-block" id="Midrule">
<a class="viewcode-back" href="../../apidocs/tabx/tabx.table.html#tabx.table.Midrule">[docs]</a>
<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Midrule</span><span class="p">(</span><span class="n">Rule</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A LaTeX midrule.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Midrule&quot;</span>

<div class="viewcode-block" id="Midrule.render">
<a class="viewcode-back" href="../../apidocs/tabx/tabx.table.html#tabx.table.Midrule.render">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="c1"># r&quot;\midrule&quot; doesn&#39;t need a latex newline `\\`</span>
        <span class="k">return</span> <span class="sa">r</span><span class="s2">&quot;\midrule&quot;</span></div>
</div>



<div class="viewcode-block" id="Bottomrule">
<a class="viewcode-back" href="../../apidocs/tabx/tabx.table.html#tabx.table.Bottomrule">[docs]</a>
<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Bottomrule</span><span class="p">(</span><span class="n">Rule</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A LaTeX bottomrule.&quot;&quot;&quot;</span>

    <span class="n">width</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Bottomrule&quot;</span>

<div class="viewcode-block" id="Bottomrule.render">
<a class="viewcode-back" href="../../apidocs/tabx/tabx.table.html#tabx.table.Bottomrule.render">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="c1"># r&quot;\midrule&quot; doesn&#39;t need a latex newline `\\`</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">r</span><span class="s2">&quot;\bottomrule[&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">+</span> <span class="s2">&quot;]&quot;</span>
        <span class="k">return</span> <span class="sa">r</span><span class="s2">&quot;\bottomrule&quot;</span></div>
</div>



<div class="viewcode-block" id="Toprule">
<a class="viewcode-back" href="../../apidocs/tabx/tabx.table.html#tabx.table.Toprule">[docs]</a>
<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Toprule</span><span class="p">(</span><span class="n">Rule</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A LaTeX toprule.&quot;&quot;&quot;</span>

    <span class="n">width</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Toprule&quot;</span>

<div class="viewcode-block" id="Toprule.render">
<a class="viewcode-back" href="../../apidocs/tabx/tabx.table.html#tabx.table.Toprule.render">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">r</span><span class="s2">&quot;\toprule[&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">+</span> <span class="s2">&quot;]&quot;</span>
        <span class="k">return</span> <span class="sa">r</span><span class="s2">&quot;\toprule&quot;</span></div>
</div>



<div class="viewcode-block" id="ColoredRow">
<a class="viewcode-back" href="../../apidocs/tabx/tabx.table.html#tabx.table.ColoredRow">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">ColoredRow</span><span class="p">(</span><span class="n">Rule</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Colored Row.</span>

<span class="sd">    Stack it above a row in a `Table` to color the row.</span>

<span class="sd">    Requires the [xcolor](https://ctan.org/pkg/xcolor?lang=en)</span>
<span class="sd">    Latex package.</span>

<span class="sd">    Examples:</span>

<span class="sd">    ```python</span>
<span class="sd">    from tabx import Table, Row, ColoredRow</span>
<span class="sd">    tab = Table.from_cells([[1, 2, 3], [4, 5, 6]])</span>
<span class="sd">    tab = ColoredRow(&quot;red&quot;) / tab</span>
<span class="sd">    ```</span>

<span class="sd">    ![table](../../figs/color_red_simple.png)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">color</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;ColoredRow(color=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">color</span><span class="si">}</span><span class="s2">)&quot;</span>

<div class="viewcode-block" id="ColoredRow.render">
<a class="viewcode-back" href="../../apidocs/tabx/tabx.table.html#tabx.table.ColoredRow.render">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">r</span><span class="s2">&quot;\rowcolor{&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">color</span> <span class="o">+</span> <span class="s2">&quot;}&quot;</span></div>
</div>



<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">IntervalCondition</span><span class="p">:</span>
    <span class="n">start</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">end</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">condition</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="s2">&quot;none&quot;</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">diff</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the difference between start and end.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span>


<span class="k">def</span><span class="w"> </span><span class="nf">interval_conditions</span><span class="p">(</span>
    <span class="n">interval</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
    <span class="n">slice_</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">IntervalCondition</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Determine how `slice_` overlaps with `interval` (both inclusive).</span>

<span class="sd">    Returns:</span>
<span class="sd">        IntervalCondition with the overlapping segment and label:</span>
<span class="sd">        - &quot;left&quot;: overlaps from the left</span>
<span class="sd">        - &quot;center&quot;: fully inside interval</span>
<span class="sd">        - &quot;right&quot;: overlaps from the right</span>
<span class="sd">        - &quot;none&quot;: no overlap</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">i_start</span><span class="p">,</span> <span class="n">i_end</span> <span class="o">=</span> <span class="n">interval</span>
    <span class="n">s_start</span><span class="p">,</span> <span class="n">s_end</span> <span class="o">=</span> <span class="n">slice_</span>

    <span class="k">match</span> <span class="p">(</span><span class="n">s_start</span> <span class="o">&lt;</span> <span class="n">i_start</span><span class="p">,</span> <span class="n">s_end</span> <span class="o">&gt;</span> <span class="n">i_end</span><span class="p">,</span> <span class="n">s_start</span> <span class="o">&gt;=</span> <span class="n">i_end</span><span class="p">,</span> <span class="n">s_end</span> <span class="o">&lt;=</span> <span class="n">i_start</span><span class="p">):</span>
        <span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="k">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="kc">True</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">IntervalCondition</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;none&quot;</span><span class="p">)</span>
        <span class="k">case</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">IntervalCondition</span><span class="p">(</span><span class="n">i_start</span><span class="p">,</span> <span class="n">s_end</span><span class="p">,</span> <span class="s2">&quot;left&quot;</span><span class="p">)</span>
        <span class="k">case</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">IntervalCondition</span><span class="p">(</span><span class="n">s_start</span><span class="p">,</span> <span class="n">i_end</span><span class="p">,</span> <span class="s2">&quot;right&quot;</span><span class="p">)</span>
        <span class="k">case</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">IntervalCondition</span><span class="p">(</span><span class="n">i_start</span><span class="p">,</span> <span class="n">i_end</span><span class="p">,</span> <span class="s2">&quot;center&quot;</span><span class="p">)</span>
        <span class="k">case</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">IntervalCondition</span><span class="p">(</span><span class="n">s_start</span><span class="p">,</span> <span class="n">s_end</span><span class="p">,</span> <span class="s2">&quot;center&quot;</span><span class="p">)</span>
        <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="n">assert_never</span><span class="p">(</span><span class="s2">&quot;Unreachable case in interval_conditions&quot;</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">is_subint</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">b</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if a is a subinterval of b.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>


<span class="n">LenMeasure</span> <span class="o">=</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;column&quot;</span><span class="p">,</span> <span class="s2">&quot;row&quot;</span><span class="p">]</span>


<span class="k">def</span><span class="w"> </span><span class="nf">slice_cells</span><span class="p">(</span>
    <span class="n">cells</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Cell</span><span class="p">],</span> <span class="n">sl</span><span class="p">:</span> <span class="nb">slice</span><span class="p">,</span> <span class="n">len_measure</span><span class="p">:</span> <span class="n">LenMeasure</span> <span class="o">=</span> <span class="s2">&quot;column&quot;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Cell</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Slices cells.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">sl</span><span class="o">.</span><span class="n">step</span> <span class="ow">or</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># Hack for getattr not having default value option</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;Step size larger than 1 not allowed, you maniac. &quot;</span>
            <span class="s2">&quot;Go outside and get some fresh air.&quot;</span>
        <span class="p">)</span>

    <span class="n">start</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="n">sl</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">sl</span><span class="o">.</span><span class="n">stop</span>

    <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">stop</span><span class="p">,</span> <span class="nb">int</span><span class="p">))</span> <span class="ow">and</span> <span class="p">(</span><span class="n">start</span> <span class="o">==</span> <span class="n">stop</span><span class="p">):</span>
        <span class="c1"># e.g. degenerate slice(0, 0), slice(1, 1) etc..</span>

        <span class="k">return</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="n">len_measure</span> <span class="o">==</span> <span class="s2">&quot;column&quot;</span><span class="p">:</span>
        <span class="n">lens</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">cells</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">lens</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">clen</span><span class="p">()</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">cells</span><span class="p">]</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">stop</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="n">stop</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">lens</span><span class="p">)</span>  <span class="c1"># 0-indexed</span>

    <span class="n">cs</span> <span class="o">=</span> <span class="n">cumsum</span><span class="p">(</span><span class="n">lens</span><span class="p">)</span>
    <span class="n">idc_s</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">cs</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">idcs</span> <span class="o">=</span> <span class="p">[(</span><span class="n">s</span><span class="p">,</span> <span class="n">s</span> <span class="o">+</span> <span class="n">e</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span><span class="p">,</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">idc_s</span><span class="p">,</span> <span class="n">lens</span><span class="p">)]</span>
    <span class="n">idc_to_f</span> <span class="o">=</span> <span class="p">{</span><span class="n">idc</span><span class="p">:</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">idc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">idcs</span><span class="p">)}</span>

    <span class="c1"># Get the cells that are in the slice</span>
    <span class="n">slice_cells</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">idc</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">idc_to_f</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">cells</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">is_mc</span><span class="p">,</span> <span class="n">is_mr</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">is_multicolumn</span><span class="p">(),</span> <span class="n">f</span><span class="o">.</span><span class="n">is_multirow</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">is_subint</span><span class="p">(</span><span class="n">idc</span><span class="p">,</span> <span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">)):</span>
            <span class="c1"># Cell is inside slice interval</span>
            <span class="n">slice_cells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">is_mc</span> <span class="ow">or</span> <span class="n">is_mr</span><span class="p">:</span>
            <span class="n">istart</span><span class="p">,</span> <span class="n">istop</span> <span class="o">=</span> <span class="n">idc</span>
            <span class="n">ic</span> <span class="o">=</span> <span class="n">interval_conditions</span><span class="p">((</span><span class="n">istart</span><span class="p">,</span> <span class="n">istop</span><span class="p">),</span> <span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">))</span>
            <span class="k">match</span> <span class="n">ic</span><span class="o">.</span><span class="n">condition</span><span class="p">:</span>
                <span class="k">case</span> <span class="s2">&quot;center&quot;</span> <span class="o">|</span> <span class="s2">&quot;left&quot;</span> <span class="o">|</span> <span class="s2">&quot;right&quot;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">is_mc</span><span class="p">:</span>
                        <span class="n">slice_cells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                            <span class="n">Cell</span><span class="p">(</span>
                                <span class="n">name</span><span class="o">=</span><span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                                <span class="n">value</span><span class="o">=</span><span class="n">f</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                                <span class="n">multicolumn</span><span class="o">=</span><span class="n">ic</span><span class="o">.</span><span class="n">diff</span><span class="p">(),</span>
                            <span class="p">)</span>
                        <span class="p">)</span>
                    <span class="k">elif</span> <span class="n">is_mr</span><span class="p">:</span>
                        <span class="n">slice_cells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                            <span class="n">Cell</span><span class="p">(</span>
                                <span class="n">name</span><span class="o">=</span><span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                                <span class="n">value</span><span class="o">=</span><span class="n">f</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                                <span class="n">multirow</span><span class="o">=</span><span class="n">ic</span><span class="o">.</span><span class="n">diff</span><span class="p">(),</span>
                            <span class="p">)</span>
                        <span class="p">)</span>
                <span class="k">case</span> <span class="s2">&quot;none&quot;</span><span class="p">:</span>
                    <span class="k">pass</span>
    <span class="k">return</span> <span class="n">slice_cells</span>


<span class="k">def</span><span class="w"> </span><span class="nf">is_contiguous</span><span class="p">(</span><span class="n">idc_rest</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]):</span>
    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span><span class="n">e</span> <span class="o">-</span> <span class="n">s</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">s</span><span class="p">,</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">idc_rest</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">idc_rest</span><span class="p">[</span><span class="mi">1</span><span class="p">:]))</span>


<span class="k">def</span><span class="w"> </span><span class="nf">slices_from_indices</span><span class="p">(</span><span class="n">indices</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">slice</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert sorted list of indices into minimal list of contiguous slices.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">indices</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[]</span>

    <span class="n">slices</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">prev</span> <span class="o">=</span> <span class="n">indices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">prev</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">prev</span> <span class="o">=</span> <span class="n">i</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">slices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">prev</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">prev</span> <span class="o">=</span> <span class="n">i</span>
    <span class="n">slices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">prev</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">slices</span>


<span class="k">def</span><span class="w"> </span><span class="nf">slice_from_set</span><span class="p">(</span><span class="n">rest</span><span class="p">:</span> <span class="nb">set</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">slice</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">slice</span><span class="p">]:</span>
    <span class="n">idc_rest</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">rest</span><span class="p">))</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">rest</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">idc_rest</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="p">(</span><span class="n">val</span><span class="p">,)</span> <span class="o">=</span> <span class="n">idc_rest</span>
        <span class="k">return</span> <span class="nb">slice</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">val</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">is_contiguous</span><span class="p">(</span><span class="n">idc_rest</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">slice</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">idc_rest</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">idc_rest</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># Including max</span>

    <span class="c1"># Non-contiguous parts; slice was inside array; e.g.</span>
    <span class="c1"># slice array[2:4] and full array array[0:6]</span>
    <span class="k">return</span> <span class="n">slices_from_indices</span><span class="p">(</span><span class="n">idc_rest</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">slice_array</span><span class="p">(</span><span class="n">array</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">Cell</span><span class="p">]],</span> <span class="n">sl</span><span class="p">:</span> <span class="nb">slice</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">Cell</span><span class="p">]]:</span>
    <span class="n">array</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>  <span class="c1"># If we slice multiple times in repl</span>

    <span class="c1"># Slice array</span>
    <span class="n">idc</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">array</span><span class="p">)))</span>
    <span class="n">idc_sl</span> <span class="o">=</span> <span class="n">idc</span><span class="p">[</span><span class="n">sl</span><span class="p">]</span>
    <span class="n">idc_rest</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">idc</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">idc_sl</span><span class="p">)</span>

    <span class="c1"># Elements that weren&#39;t sliced</span>
    <span class="n">sl_rest</span> <span class="o">=</span> <span class="n">slice_from_set</span><span class="p">(</span><span class="n">idc_rest</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sl_rest</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">rest</span> <span class="o">=</span> <span class="p">[</span><span class="n">subarr</span> <span class="k">for</span> <span class="n">slr</span> <span class="ow">in</span> <span class="n">sl_rest</span> <span class="k">for</span> <span class="n">subarr</span> <span class="ow">in</span> <span class="n">array</span><span class="p">[</span><span class="n">slr</span><span class="p">]]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">rest</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="n">sl_rest</span><span class="p">]</span>

    <span class="n">selected</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="n">sl</span><span class="p">]</span>

    <span class="c1"># Check if elements in the non-selected parts are part of a multirow</span>
    <span class="c1"># - if emptycell then we unlink it</span>
    <span class="c1"># - if multirowcell we add it to dict for further logic below</span>
    <span class="n">mr_map</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">MultirowCell</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">MrEmptyCell</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">rest</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">ele</span> <span class="ow">in</span> <span class="n">row</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ele</span><span class="p">,</span> <span class="n">MrEmptyCell</span><span class="p">):</span>
                <span class="n">ele</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ele</span><span class="p">,</span> <span class="n">MultirowCell</span><span class="p">):</span>
                <span class="n">mr_map</span><span class="p">[</span><span class="n">ele</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Slice from above rows[2:] logic where multirow in rows[:2] and its</span>
    <span class="c1"># empty cells inside rows[2:].</span>
    <span class="c1"># Find mrempty cells in the selected slice and add them to the mr_map</span>
    <span class="c1"># if their multirow has been removed by the slice</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">selected</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">ele</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ele</span><span class="p">,</span> <span class="n">MrEmptyCell</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">ele</span><span class="o">.</span><span class="n">mr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">ele</span><span class="o">.</span><span class="n">mr</span> <span class="ow">in</span> <span class="n">mr_map</span><span class="p">:</span>
                    <span class="n">mr_map</span><span class="p">[</span><span class="n">ele</span><span class="o">.</span><span class="n">mr</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ele</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>

    <span class="c1"># Swap non-selected multirows with its first empty cell in the</span>
    <span class="c1"># selected part and unlink the cell.</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">mr_map</span><span class="p">:</span>
        <span class="n">vals</span> <span class="o">=</span> <span class="n">mr_map</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">vals</span><span class="p">:</span>
            <span class="n">vals</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">operator</span><span class="o">.</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
            <span class="n">cell</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">operator</span><span class="o">.</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
            <span class="n">selected</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">k</span>
            <span class="n">cell</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">array</span><span class="p">[</span><span class="n">sl</span><span class="p">]</span>


<span class="k">def</span><span class="w"> </span><span class="nf">slice_rows_horizontal</span><span class="p">(</span><span class="n">cols</span><span class="p">:</span> <span class="n">Columns</span> <span class="o">|</span> <span class="n">Table</span><span class="p">,</span> <span class="n">sl</span><span class="p">:</span> <span class="nb">slice</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Slices each row in the columns by `sl`.</span>

<span class="sd">    Corresponds to a slice across columns i.e. cols[:, n:m]</span>
<span class="sd">    in familiar numpy notation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="n">cols</span><span class="o">.</span><span class="n">all_rows</span><span class="p">()</span>
    <span class="n">sliced_rows</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="p">(</span><span class="n">Cmidrule</span><span class="p">,</span> <span class="n">Cmidrules</span><span class="p">)):</span>
            <span class="c1"># If sl.start is None we slice whole range from left hence no</span>
            <span class="c1"># standardization</span>
            <span class="n">sliced_rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">sl</span><span class="p">,</span> <span class="n">standardize</span><span class="o">=</span><span class="n">sl</span><span class="o">.</span><span class="n">start</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sliced_rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="n">sl</span><span class="p">])</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cols</span><span class="p">,</span> <span class="n">Table</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Table</span><span class="o">.</span><span class="n">from_columns</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">Columns</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="n">sliced_rows</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">Columns</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="n">sliced_rows</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">slice_rows_vertical</span><span class="p">(</span><span class="n">cols</span><span class="p">:</span> <span class="n">Columns</span> <span class="o">|</span> <span class="n">Table</span><span class="p">,</span> <span class="n">sl</span><span class="p">:</span> <span class="nb">slice</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Slices the columns by `sl` and returns a new Columns object.</span>

<span class="sd">    Corresponds to a slice cols[n:m] across rows in familiar numpy notation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">sl</span><span class="o">.</span><span class="n">start</span> <span class="ow">and</span> <span class="n">sl</span><span class="o">.</span><span class="n">stop</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">sl</span><span class="o">.</span><span class="n">start</span> <span class="o">==</span> <span class="n">sl</span><span class="o">.</span><span class="n">stop</span><span class="p">):</span>
        <span class="n">ecols</span> <span class="o">=</span> <span class="n">Columns</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="p">[],</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;c&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ecols</span><span class="p">,</span> <span class="n">Table</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">Table</span><span class="o">.</span><span class="n">from_columns</span><span class="p">(</span><span class="n">ecols</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ecols</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="n">cols</span><span class="o">.</span><span class="n">all_rows</span><span class="p">()</span>
    <span class="n">array</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">orig</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="n">idc</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rows</span><span class="p">)))</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">rows</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">Row</span><span class="p">):</span>
            <span class="n">array</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">cells</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">array</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">Placeholder</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cols</span><span class="o">.</span><span class="n">ncols</span><span class="p">)])</span>
            <span class="n">orig</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span>

    <span class="n">new_rows</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">slices</span> <span class="o">=</span> <span class="n">slice_array</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">sl</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">cells</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">idc</span><span class="p">[</span><span class="n">sl</span><span class="p">],</span> <span class="n">slices</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">orig</span><span class="p">:</span>
            <span class="n">new_rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">orig</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Row</span><span class="p">(</span><span class="n">cells</span><span class="o">=</span><span class="n">cells</span><span class="p">))</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cols</span><span class="p">,</span> <span class="n">Table</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Table</span><span class="o">.</span><span class="n">from_columns</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">Columns</span><span class="p">(</span><span class="n">new_rows</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="n">cols</span><span class="o">.</span><span class="n">align</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">Columns</span><span class="p">(</span><span class="n">new_rows</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="n">cols</span><span class="o">.</span><span class="n">align</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">index_to_slice</span><span class="p">(</span><span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">values</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">slice</span><span class="p">:</span>
    <span class="n">idc</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)))</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">idc</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Index </span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s2"> out of bounds with </span><span class="si">{</span><span class="n">idc</span><span class="si">=}</span><span class="s2"> and</span><span class="si">{</span><span class="n">values</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">slice</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">standardize_index</span><span class="p">(</span><span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">))[</span><span class="n">index</span><span class="p">]</span>


<div class="viewcode-block" id="Row">
<a class="viewcode-back" href="../../apidocs/tabx/tabx.table.html#tabx.table.Row">[docs]</a>
<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Row</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A row in a table.</span>

<span class="sd">    Consists of a sequence of `Cell` objects.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">cells</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Cell</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span>
            <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">Sequence</span><span class="p">)</span>
            <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">Cell</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="s2">&quot;Cells must be a sequence of Cell objects.&quot;</span>
                <span class="sa">f</span><span class="s2">&quot; Got </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="si">=}</span><span class="s2"> of types </span><span class="si">{</span><span class="p">[</span><span class="nb">type</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Row(#cells=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span> <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">slice</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Row</span><span class="p">:</span>
        <span class="n">cells</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cells</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">Row</span><span class="p">(</span><span class="n">cells</span><span class="o">=</span><span class="n">slice_cells</span><span class="p">(</span><span class="n">cells</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="s2">&quot;column&quot;</span><span class="p">))</span>
        <span class="n">sl</span> <span class="o">=</span> <span class="n">index_to_slice</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">cells</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Row</span><span class="p">(</span><span class="n">cells</span><span class="o">=</span><span class="n">slice_cells</span><span class="p">(</span><span class="n">cells</span><span class="p">,</span> <span class="n">sl</span><span class="p">,</span> <span class="s2">&quot;column&quot;</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">cell</span><span class="p">:</span> <span class="n">Cell</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cells</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">)</span>  <span class="c1"># Sequence doesn&#39;t allow setitem</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">cell</span>

<div class="viewcode-block" id="Row.render">
<a class="viewcode-back" href="../../apidocs/tabx/tabx.table.html#tabx.table.Row.render">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot; &amp; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cell</span><span class="o">.</span><span class="n">render</span><span class="p">()</span> <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">)</span> <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot; </span><span class="se">\\</span><span class="s2">&quot;</span></div>


    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Table</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span> <span class="o">...</span>

    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Columns</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Columns</span><span class="p">:</span> <span class="o">...</span>

    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Cmidrules</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Columns</span><span class="p">:</span> <span class="o">...</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">TableRow_</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">Columns</span><span class="p">([</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Table</span> <span class="o">|</span> <span class="n">Columns</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">other</span><span class="o">.</span><span class="n">prepend_row</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;unsupported operand type(s) for /: &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;and &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
        <span class="p">)</span>

    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__or__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Columns</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Columns</span><span class="p">:</span> <span class="o">...</span>

    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__or__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Row</span> <span class="o">|</span> <span class="n">Cell</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Row</span><span class="p">:</span> <span class="o">...</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__or__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Columns</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">Columns</span><span class="p">([</span><span class="bp">self</span><span class="p">])</span> <span class="o">|</span> <span class="n">other</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Row</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">Row</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">)</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">cells</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Cell</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">Row</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cells</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="n">other</span><span class="p">])</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;unsupported operand type(s) for |: &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;and &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
        <span class="p">)</span></div>



<span class="n">TableRow_</span> <span class="o">=</span> <span class="p">(</span><span class="n">Row</span><span class="p">,</span> <span class="n">Cmidrule</span><span class="p">,</span> <span class="n">Cmidrules</span><span class="p">,</span> <span class="n">Rule</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">len_rows</span><span class="p">(</span><span class="n">rows</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">TableRow</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">set</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Counts the number of cells in each row.</span>

<span class="sd">    - Midrules don&#39;t count towards #cells in a given row.</span>
<span class="sd">        - Cmidrule, Cmidrules, and Midrule</span>
<span class="sd">        - This is the reason for their __len__ returning 0.</span>
<span class="sd">    - Applying `len` to a Cell measures how many columns it occupies.</span>
<span class="sd">      If it is a multicolumn cell, it will count as that many columns.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">set</span><span class="p">(</span>
        <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="p">(</span><span class="n">Cmidrule</span><span class="p">,</span> <span class="n">Cmidrules</span><span class="p">,</span> <span class="n">Rule</span><span class="p">))]</span>
    <span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">render_rows</span><span class="p">(</span><span class="n">rows</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">TableRow</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Renders a sequence of `TableRow` objects to a LaTeX table body.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">render</span><span class="p">()</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">int_idx_to_slice</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles negative index by delegating to usual python indexing.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">index</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">))[</span><span class="n">index</span><span class="p">]</span>
    <span class="n">sl</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">sl</span>


<span class="k">def</span><span class="w"> </span><span class="nf">validate_rows</span><span class="p">(</span><span class="n">rows</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">TableRow</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the length of the rows i.e. the number of columns.</span>
<span class="sd">    Raises ValueError if the rows are not of the same length.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">rows</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">abc</span><span class="o">.</span><span class="n">Sequence</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Rows must be a Sequence of TableRow objects; got </span><span class="si">{</span><span class="n">rows</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">TableRow_</span><span class="p">)</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="s2">&quot;All elements of rows must be TableRow instances; got &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="p">[</span><span class="nb">type</span><span class="p">(</span><span class="n">row</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">row</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">rows</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="n">s</span> <span class="o">=</span> <span class="n">len_rows</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;All rows must have same #cells i.e. columns differ.&quot;</span>
            <span class="sa">f</span><span class="s2">&quot; Found unique row lengths: </span><span class="si">{</span><span class="n">s</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Empty column or only (c)midrules</span>
        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">Midrule</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">):</span>
            <span class="k">return</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="p">(</span><span class="n">Cmidrule</span><span class="p">,</span> <span class="n">Cmidrules</span><span class="p">,</span> <span class="n">Midrule</span><span class="p">))</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">):</span>
            <span class="n">rows</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">Sequence</span><span class="p">[</span><span class="n">Cmidrule</span> <span class="o">|</span> <span class="n">Cmidrules</span> <span class="o">|</span> <span class="n">Midrule</span><span class="p">],</span> <span class="n">rows</span><span class="p">)</span>
            <span class="n">min_start</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span>
                <span class="n">r</span><span class="o">.</span><span class="n">start</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">rows</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="p">(</span><span class="n">Cmidrule</span><span class="p">,</span> <span class="n">Cmidrules</span><span class="p">))</span>
            <span class="p">)</span>
            <span class="n">max_end</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">end</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">rows</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="p">(</span><span class="n">Cmidrule</span><span class="p">,</span> <span class="n">Cmidrules</span><span class="p">)))</span>
            <span class="k">return</span> <span class="n">max_end</span> <span class="o">-</span> <span class="n">min_start</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="c1"># Unique single element which is the number of columns</span>
    <span class="n">ncols</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">s</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">ncols</span>


<span class="k">def</span><span class="w"> </span><span class="nf">is_type_seq</span><span class="p">(</span><span class="n">seq</span><span class="p">,</span> <span class="n">type_</span><span class="p">:</span> <span class="nb">type</span> <span class="o">=</span> <span class="nb">int</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="nb">isinstance</span><span class="p">(</span><span class="n">seq</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">)</span>
        <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
        <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">type_</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">seq</span><span class="p">)</span>
    <span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">is_seq_of_type_seq</span><span class="p">(</span><span class="n">seq</span><span class="p">,</span> <span class="n">type_</span><span class="p">:</span> <span class="nb">type</span> <span class="o">=</span> <span class="nb">int</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="nb">isinstance</span><span class="p">(</span><span class="n">seq</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">)</span>
        <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
        <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span><span class="n">is_type_seq</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">type_</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">seq</span><span class="p">)</span>
    <span class="p">)</span>


<span class="nb">type</span> <span class="n">SequenceKind</span> <span class="o">=</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;seq&quot;</span><span class="p">,</span> <span class="s2">&quot;seq_of_seq&quot;</span><span class="p">,</span> <span class="s2">&quot;other&quot;</span><span class="p">]</span>


<span class="k">def</span><span class="w"> </span><span class="nf">match_seq</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">type_</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SequenceKind</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Matches x and returns the type of sequence.</span>

<span class="sd">    - &quot;seq&quot;: Sequence of type</span>
<span class="sd">    - &quot;seq_of_seq&quot;: Sequence of sequences of type</span>
<span class="sd">    - &quot;other&quot;: Other type</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">match</span> <span class="n">x</span><span class="p">:</span>
        <span class="k">case</span> <span class="n">Sequence</span><span class="p">()</span> <span class="k">if</span> <span class="n">is_type_seq</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">type_</span><span class="p">):</span>
            <span class="k">return</span> <span class="s2">&quot;seq&quot;</span>
        <span class="k">case</span> <span class="n">Sequence</span><span class="p">()</span> <span class="k">if</span> <span class="n">is_seq_of_type_seq</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">type_</span><span class="p">):</span>
            <span class="k">return</span> <span class="s2">&quot;seq_of_seq&quot;</span>
        <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;other&quot;</span>


<span class="k">class</span><span class="w"> </span><span class="nc">Rows</span><span class="p">:</span>
    <span class="n">values</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">TableRow</span><span class="p">]</span>
    <span class="n">ncols</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">nrows</span><span class="p">:</span> <span class="nb">int</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="o">...</span>


<div class="viewcode-block" id="Columns">
<a class="viewcode-back" href="../../apidocs/tabx/tabx.table.html#tabx.table.Columns">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Columns</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Columns class for LaTeX tables.</span>

<span class="sd">    This is the base of the `Table` object.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">ncols</span><span class="p">:</span> <span class="nb">int</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Number of columns in the table.&quot;&quot;&quot;</span>
    <span class="n">nrows</span><span class="p">:</span> <span class="nb">int</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Number of rows in the table.&quot;&quot;&quot;</span>
    <span class="n">rows</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">TableRow</span><span class="p">]</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;List of rows in the table.&quot;&quot;&quot;</span>
    <span class="n">align</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Alignment string of columns&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rows</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">TableRow</span><span class="p">],</span> <span class="n">align</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rows</span> <span class="o">=</span> <span class="n">rows</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">align</span> <span class="o">=</span> <span class="n">align</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__post_init__</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># ncols</span>
        <span class="n">ncols</span> <span class="o">=</span> <span class="n">validate_rows</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ncols</span><span class="p">:</span>
            <span class="c1"># empty columns</span>
            <span class="n">ncols</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ncols</span> <span class="o">=</span> <span class="n">ncols</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nrows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">align</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">align</span> <span class="o">=</span> <span class="s2">&quot;c&quot;</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncols</span>

        <span class="c1"># Validate rows in columns; linking multirows and their cells</span>
        <span class="n">validate_column_rows</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">)</span>
        <span class="n">validate_cmidrules</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Columns(nrows=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nrows</span><span class="si">}</span><span class="s2">, ncols=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ncols</span><span class="si">}</span><span class="s2">)&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrows</span>

<div class="viewcode-block" id="Columns.render">
<a class="viewcode-back" href="../../apidocs/tabx/tabx.table.html#tabx.table.Columns.render">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">body</span> <span class="o">=</span> <span class="n">render_rows</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">body</span></div>


<div class="viewcode-block" id="Columns.set_align">
<a class="viewcode-back" href="../../apidocs/tabx/tabx.table.html#tabx.table.Columns.set_align">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_align</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">align</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the alignment of the columns.</span>

<span class="sd">        Hard to validate as e.g. with colored columns the alignment</span>
<span class="sd">        string becomes long and verbose.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">align</span> <span class="o">=</span> <span class="n">align</span>
        <span class="k">return</span> <span class="bp">self</span></div>


<div class="viewcode-block" id="Columns.all_rows">
<a class="viewcode-back" href="../../apidocs/tabx/tabx.table.html#tabx.table.Columns.all_rows">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">all_rows</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">TableRow</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return all rows&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span></div>


<div class="viewcode-block" id="Columns.total_rows">
<a class="viewcode-back" href="../../apidocs/tabx/tabx.table.html#tabx.table.Columns.total_rows">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">total_rows</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return total number of rows, including header.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">)</span></div>


<div class="viewcode-block" id="Columns.print_rows">
<a class="viewcode-back" href="../../apidocs/tabx/tabx.table.html#tabx.table.Columns.print_rows">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">print_rows</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">rows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_rows</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">Row</span><span class="p">):</span>
                <span class="n">row_str</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">row</span><span class="o">.</span><span class="n">cells</span><span class="p">])</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">Cmidrules</span><span class="p">):</span>
                <span class="n">row_str</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">row</span><span class="o">.</span><span class="n">values</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">row_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Row: </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">: [</span><span class="si">{</span><span class="n">row_str</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">shape</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the shape of the table.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrows</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncols</span>

<div class="viewcode-block" id="Columns.print">
<a class="viewcode-back" href="../../apidocs/tabx/tabx.table.html#tabx.table.Columns.print">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">print</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">render</span><span class="p">())</span></div>


<div class="viewcode-block" id="Columns.prepend_row">
<a class="viewcode-back" href="../../apidocs/tabx/tabx.table.html#tabx.table.Columns.prepend_row">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">prepend_row</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">:</span> <span class="n">TableRow</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Prepend a row.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">TableRow_</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Row must be a TableRow object; got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">row</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Columns</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="p">[</span><span class="n">row</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">),</span> <span class="n">align</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">align</span><span class="p">)</span></div>


<div class="viewcode-block" id="Columns.append_row">
<a class="viewcode-back" href="../../apidocs/tabx/tabx.table.html#tabx.table.Columns.append_row">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">append_row</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">:</span> <span class="n">TableRow</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Append a row&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">TableRow_</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Row must be a TableRow object; got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">row</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Columns</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="n">row</span><span class="p">],</span> <span class="n">align</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">align</span><span class="p">)</span></div>


<div class="viewcode-block" id="Columns.insert_row">
<a class="viewcode-back" href="../../apidocs/tabx/tabx.table.html#tabx.table.Columns.insert_row">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">insert_row</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">:</span> <span class="n">TableRow</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Insert a row at index.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">TableRow_</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Row must be a TableRow object; got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">row</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">index</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nrows</span><span class="p">))[</span><span class="n">index</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">Columns</span><span class="p">(</span>
            <span class="n">rows</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">[:</span><span class="n">index</span><span class="p">])</span> <span class="o">+</span> <span class="p">[</span><span class="n">row</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="n">index</span><span class="p">:]),</span>
            <span class="n">align</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">align</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="Columns.from_cells">
<a class="viewcode-back" href="../../apidocs/tabx/tabx.table.html#tabx.table.Columns.from_cells">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_cells</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">cells</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Cell</span><span class="p">]</span> <span class="o">|</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="n">Cell</span><span class="p">]],</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a Column from a sequence of cells.&quot;&quot;&quot;</span>
        <span class="k">match</span> <span class="n">match_seq</span><span class="p">(</span><span class="n">cells</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="n">Cell</span><span class="p">):</span>
            <span class="k">case</span> <span class="s2">&quot;seq&quot;</span><span class="p">:</span>
                <span class="n">cells</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">Sequence</span><span class="p">[</span><span class="n">Cell</span><span class="p">],</span> <span class="n">cells</span><span class="p">)</span>
                <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
                    <span class="n">rows</span><span class="o">=</span><span class="p">[</span><span class="n">Row</span><span class="p">([</span><span class="n">cell</span><span class="p">])</span> <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">cells</span><span class="p">],</span>
                <span class="p">)</span>
            <span class="k">case</span> <span class="s2">&quot;seq_of_seq&quot;</span><span class="p">:</span>
                <span class="n">cells</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="n">Cell</span><span class="p">]],</span> <span class="n">cells</span><span class="p">)</span>
                <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
                    <span class="n">rows</span><span class="o">=</span><span class="p">[</span><span class="n">Row</span><span class="p">([</span><span class="n">cell</span> <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">row</span><span class="p">])</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">cells</span><span class="p">],</span>
                <span class="p">)</span>
            <span class="k">case</span> <span class="s2">&quot;other&quot;</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Cells must be a sequence of Cell objects or a &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;sequence of sequence of Cell objects; got </span><span class="si">{</span><span class="n">cells</span><span class="si">=}</span><span class="s2">&quot;</span>
                <span class="p">)</span></div>


<div class="viewcode-block" id="Columns.from_values">
<a class="viewcode-back" href="../../apidocs/tabx/tabx.table.html#tabx.table.Columns.from_values">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_values</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">values</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">NumOrStr</span><span class="p">]</span> <span class="o">|</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="n">NumOrStr</span><span class="p">]],</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a Column from a sequence of values.</span>


<span class="sd">        Values could be str, int, float.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">TableRow_</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">values</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot pass TableRow_ as value&quot;</span><span class="p">)</span>
        <span class="k">match</span> <span class="n">match_seq</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">type_</span><span class="o">=</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">)):</span>
            <span class="k">case</span> <span class="s2">&quot;seq&quot;</span><span class="p">:</span>
                <span class="n">values</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">Sequence</span><span class="p">[</span><span class="n">NumOrStr</span><span class="p">],</span> <span class="n">values</span><span class="p">)</span>
                <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
                    <span class="n">rows</span><span class="o">=</span><span class="p">[</span><span class="n">Row</span><span class="p">([</span><span class="n">Cell</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">))])</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">],</span>
                <span class="p">)</span>
            <span class="k">case</span> <span class="s2">&quot;seq_of_seq&quot;</span><span class="p">:</span>
                <span class="n">values</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="n">NumOrStr</span><span class="p">]],</span> <span class="n">values</span><span class="p">)</span>
                <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
                    <span class="n">rows</span><span class="o">=</span><span class="p">[</span><span class="n">Row</span><span class="p">([</span><span class="n">Cell</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">))</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">row</span><span class="p">])</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">values</span><span class="p">],</span>
                <span class="p">)</span>
            <span class="k">case</span> <span class="s2">&quot;other&quot;</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Cells must be a sequence of objects or a &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;sequence of sequence of objects; got </span><span class="si">{</span><span class="n">values</span><span class="si">=}</span><span class="s2">&quot;</span>
                <span class="p">)</span></div>


    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">slice</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">slice</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">slice</span> <span class="o">|</span> <span class="nb">int</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Columns</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">sl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_save_index_to_slice</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrows</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">slice_rows_vertical</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sl</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">slice_rows_vertical</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">idx_row</span><span class="p">,</span> <span class="n">idx_column</span> <span class="o">=</span> <span class="n">index</span>
            <span class="c1"># handle case of either being an integer</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">idx_row</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                <span class="n">idx_row</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_save_index_to_slice</span><span class="p">(</span><span class="n">idx_row</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrows</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">idx_column</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                <span class="n">idx_column</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_save_index_to_slice</span><span class="p">(</span><span class="n">idx_column</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncols</span><span class="p">)</span>
            <span class="c1"># Slice and return</span>
            <span class="n">cols</span> <span class="o">=</span> <span class="n">slice_rows_vertical</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx_row</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">slice_rows_horizontal</span><span class="p">(</span><span class="n">cols</span><span class="p">,</span> <span class="n">idx_column</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Index </span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s2"> not valid&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_save_index_to_slice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">slice</span> <span class="o">=</span> <span class="n">int_idx_to_slice</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Index </span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s2"> out of bounds for </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">slice</span>

    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__or__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Table</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span> <span class="o">...</span>

    <span class="c1"># (col | tab) | tab -&gt; tab</span>

    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__or__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span> <span class="o">...</span>

    <span class="c1"># tab | cols -&gt; tab; cols | cols -&gt; cols</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__or__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Columns</span> <span class="o">|</span> <span class="n">Table</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Overload `|`&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Cell</span><span class="p">):</span>
            <span class="n">other</span> <span class="o">=</span> <span class="n">Columns</span><span class="p">([</span><span class="n">Row</span><span class="p">([</span><span class="n">other</span><span class="p">])])</span>  <span class="c1"># delegate to Columns below</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Row</span><span class="p">):</span>
            <span class="n">other</span> <span class="o">=</span> <span class="n">Columns</span><span class="p">([</span><span class="n">other</span><span class="p">])</span>  <span class="c1"># delegate to Columns below</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Table</span><span class="p">):</span>
            <span class="n">cols</span> <span class="o">=</span> <span class="n">join_columns</span><span class="p">([</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">Table</span><span class="o">.</span><span class="n">from_columns</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Columns</span><span class="p">):</span>
            <span class="n">cols</span> <span class="o">=</span> <span class="n">join_columns</span><span class="p">([</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Table</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">Table</span><span class="o">.</span><span class="n">from_columns</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">cols</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;unsupported operand type(s) for |: &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;and &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
        <span class="p">)</span>

    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Table</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span> <span class="o">...</span>

    <span class="c1"># (col | tab) | tab -&gt; tab</span>

    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span> <span class="o">...</span>

    <span class="c1"># tab | cols -&gt; tab; cols | cols -&gt; cols</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">Columns</span> <span class="o">|</span> <span class="n">Table</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Overload `/`&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Cell</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">append_row</span><span class="p">(</span><span class="n">Row</span><span class="p">([</span><span class="n">other</span><span class="p">]))</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="p">(</span><span class="n">Rule</span><span class="p">,</span> <span class="n">Row</span><span class="p">,</span> <span class="n">Cmidrule</span><span class="p">,</span> <span class="n">Cmidrules</span><span class="p">)):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">append_row</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Table</span><span class="p">):</span>
            <span class="n">cols</span> <span class="o">=</span> <span class="n">join_rows</span><span class="p">([</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">Table</span><span class="o">.</span><span class="n">from_columns</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Columns</span><span class="p">):</span>
            <span class="n">cols</span> <span class="o">=</span> <span class="n">join_rows</span><span class="p">([</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Table</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">Table</span><span class="o">.</span><span class="n">from_columns</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">cols</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;unsupported operand type(s) for /: &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;and &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Columns</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">()</span>
        <span class="n">equal_rows</span> <span class="o">=</span> <span class="nb">all</span><span class="p">(</span>
            <span class="p">[</span><span class="n">r1</span> <span class="o">==</span> <span class="n">r2</span> <span class="k">for</span> <span class="n">r1</span><span class="p">,</span> <span class="n">r2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">all_rows</span><span class="p">(),</span> <span class="n">other</span><span class="o">.</span><span class="n">all_rows</span><span class="p">())]</span>
        <span class="p">)</span>
        <span class="n">equal_dim</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nrows</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncols</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">nrows</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">ncols</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">equal_rows</span> <span class="ow">and</span> <span class="n">equal_dim</span></div>



<span class="k">class</span><span class="w"> </span><span class="nc">Column</span><span class="p">(</span><span class="n">Columns</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">rows</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">TableRow</span><span class="p">],</span>
        <span class="n">align</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">align</span><span class="p">:</span>
            <span class="n">align</span> <span class="o">=</span> <span class="s2">&quot;c&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">align</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Column alignment must be a single character. Found: </span><span class="si">{</span><span class="n">align</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="n">rows</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="n">align</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncols</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Column must have exactly 1 column. Found: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ncols</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">validate_column_rows</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the number of rows in the column.</span>

<span class="sd">        Everything counts as a row, including (c)midrules.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Column(#rows=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">)</span><span class="si">}</span><span class="s2">, n=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ncols</span><span class="si">}</span><span class="s2">)&quot;</span>


<div class="viewcode-block" id="Table">
<a class="viewcode-back" href="../../apidocs/tabx/tabx.table.html#tabx.table.Table">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Table</span><span class="p">(</span><span class="n">Columns</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Table class for LaTeX tables.</span>

<span class="sd">    This is the main class for creating LaTeX tables.</span>
<span class="sd">    Implementation wise a `Table` is a `Columns` object with some extras</span>
<span class="sd">    functionality.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rows</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">TableRow</span><span class="p">],</span> <span class="n">align</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="n">rows</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="n">align</span><span class="p">)</span>

<div class="viewcode-block" id="Table.from_columns">
<a class="viewcode-back" href="../../apidocs/tabx/tabx.table.html#tabx.table.Table.from_columns">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_columns</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">columns</span><span class="p">:</span> <span class="n">Columns</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a Table from rows.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="n">columns</span><span class="o">.</span><span class="n">rows</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="n">columns</span><span class="o">.</span><span class="n">align</span><span class="p">)</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">columns</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Columns</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the columns of the table.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Columns</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">align</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">slice</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="nb">slice</span><span class="p">,</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">slice</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Table</span><span class="o">.</span><span class="n">from_columns</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Table(nrows=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nrows</span><span class="si">}</span><span class="s2">, ncols=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ncols</span><span class="si">}</span><span class="s2">)&quot;</span>

<div class="viewcode-block" id="Table.render">
<a class="viewcode-back" href="../../apidocs/tabx/tabx.table.html#tabx.table.Table.render">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">render</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">custom_render</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="n">args</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Render the table to a LaTeX string.</span>

<span class="sd">        It wraps the table in a tabular environment by default.</span>
<span class="sd">        If `custom_render` is provided, it will be used to render the table.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncols</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrows</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot render empty table&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">custom_render</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">custom_render</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">body</span> <span class="o">=</span> <span class="n">render_rows</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">render_body</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ncols</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">align</span><span class="p">)</span></div>


<div class="viewcode-block" id="Table.render_body">
<a class="viewcode-back" href="../../apidocs/tabx/tabx.table.html#tabx.table.Table.render_body">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">render_body</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Render the body of the table without the tabular environment.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">render_rows</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">)</span></div>


<div class="viewcode-block" id="Table.prepend_row">
<a class="viewcode-back" href="../../apidocs/tabx/tabx.table.html#tabx.table.Table.prepend_row">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">prepend_row</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">:</span> <span class="n">TableRow</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Prepend a row.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Table</span><span class="o">.</span><span class="n">from_columns</span><span class="p">(</span><span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">prepend_row</span><span class="p">(</span><span class="n">row</span><span class="p">))</span></div>


<div class="viewcode-block" id="Table.append_row">
<a class="viewcode-back" href="../../apidocs/tabx/tabx.table.html#tabx.table.Table.append_row">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">append_row</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">:</span> <span class="n">TableRow</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;add a row.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Table</span><span class="o">.</span><span class="n">from_columns</span><span class="p">(</span><span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">append_row</span><span class="p">(</span><span class="n">row</span><span class="p">))</span></div>


<div class="viewcode-block" id="Table.insert_row">
<a class="viewcode-back" href="../../apidocs/tabx/tabx.table.html#tabx.table.Table.insert_row">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">insert_row</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">:</span> <span class="n">TableRow</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;insert a row.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Table</span><span class="o">.</span><span class="n">from_columns</span><span class="p">(</span><span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">insert_row</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">index</span><span class="p">))</span></div>


<div class="viewcode-block" id="Table.print">
<a class="viewcode-back" href="../../apidocs/tabx/tabx.table.html#tabx.table.Table.print">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">print</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">custom_render</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">custom_render</span><span class="p">))</span></div>


<div class="viewcode-block" id="Table.from_cells">
<a class="viewcode-back" href="../../apidocs/tabx/tabx.table.html#tabx.table.Table.from_cells">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_cells</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">cells</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Cell</span><span class="p">]</span> <span class="o">|</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="n">Cell</span><span class="p">]],</span>
    <span class="p">):</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">Columns</span><span class="o">.</span><span class="n">from_cells</span><span class="p">(</span><span class="n">cells</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_columns</span><span class="p">(</span><span class="n">out</span><span class="p">)</span></div>


<div class="viewcode-block" id="Table.from_values">
<a class="viewcode-back" href="../../apidocs/tabx/tabx.table.html#tabx.table.Table.from_values">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_values</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">values</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">NumOrStr</span><span class="p">]</span> <span class="o">|</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="n">NumOrStr</span><span class="p">]],</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Construct Table from values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">Columns</span><span class="o">.</span><span class="n">from_values</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_columns</span><span class="p">(</span><span class="n">out</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="empty_columns">
<a class="viewcode-back" href="../../apidocs/tabx/tabx.table.html#tabx.table.empty_columns">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">empty_columns</span><span class="p">(</span><span class="n">nrows</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">ncols</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create empty columns with `nrows` and `ncols`.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Columns</span><span class="p">(</span>
        <span class="n">rows</span><span class="o">=</span><span class="p">[</span><span class="n">Row</span><span class="p">(</span><span class="n">empty_cells</span><span class="p">(</span><span class="n">ncols</span><span class="p">))</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)],</span>
        <span class="n">align</span><span class="o">=</span><span class="s2">&quot;c&quot;</span> <span class="o">*</span> <span class="n">ncols</span><span class="p">,</span>
    <span class="p">)</span></div>



<div class="viewcode-block" id="filled_columns">
<a class="viewcode-back" href="../../apidocs/tabx/tabx.table.html#tabx.table.filled_columns">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">filled_columns</span><span class="p">(</span><span class="n">nrows</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">ncols</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates columns with `nrows` and `ncols` filled with `value`.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Columns</span><span class="p">(</span>
        <span class="n">rows</span><span class="o">=</span><span class="p">[</span><span class="n">Row</span><span class="p">([</span><span class="n">Cell</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)])</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)],</span>
    <span class="p">)</span></div>



<div class="viewcode-block" id="empty_table">
<a class="viewcode-back" href="../../apidocs/tabx/tabx.table.html#tabx.table.empty_table">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">empty_table</span><span class="p">(</span><span class="n">nrows</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">ncols</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create an empty table with `nrows` and `ncols`.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Table</span><span class="o">.</span><span class="n">from_columns</span><span class="p">(</span><span class="n">empty_columns</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">))</span></div>



<div class="viewcode-block" id="filled_table">
<a class="viewcode-back" href="../../apidocs/tabx/tabx.table.html#tabx.table.filled_table">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">filled_table</span><span class="p">(</span><span class="n">nrows</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">ncols</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a table with `nrows` and `ncols` filled with `value`.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Table</span><span class="o">.</span><span class="n">from_columns</span><span class="p">(</span><span class="n">filled_columns</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span></div>



<span class="k">def</span><span class="w"> </span><span class="nf">reduce_cells_to_col</span><span class="p">(</span><span class="n">cells</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Cell</span> <span class="o">|</span> <span class="n">Columns</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Columns</span><span class="p">:</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">x</span> <span class="o">/</span> <span class="n">y</span><span class="p">,</span> <span class="n">cells</span><span class="p">)</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">Columns</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">out</span>


<span class="k">def</span><span class="w"> </span><span class="nf">reduce_vertical</span><span class="p">(</span><span class="n">objs</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">x</span> <span class="o">/</span> <span class="n">y</span><span class="p">,</span> <span class="n">objs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">out</span>


<span class="k">def</span><span class="w"> </span><span class="nf">reduce_horizontal</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Cannot use this with multirow cells while they should be linked</span>
<span class="sd">    across the table.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">TableRow_</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">values</span>
    <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">Cell</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">values</span><span class="p">):</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">Sequence</span><span class="p">[</span><span class="n">Cell</span><span class="p">],</span> <span class="n">values</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">x</span> <span class="o">|</span> <span class="n">y</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid </span><span class="si">{</span><span class="n">values</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">validate_next_cells_mr</span><span class="p">(</span>
    <span class="n">next_cells</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Cell</span><span class="p">],</span>
    <span class="n">clen</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">n_empty</span> <span class="o">:=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">f</span><span class="o">.</span><span class="n">is_empty</span><span class="p">()</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">next_cells</span><span class="p">]))</span> <span class="o">==</span> <span class="n">clen</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">nf</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">next_cells</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Multirow cell with #rows=</span><span class="si">{</span><span class="n">clen</span><span class="si">}</span><span class="s2"> should always be &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;followed by </span><span class="si">{</span><span class="n">clen</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2"> empty cells, but found &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">nf</span><span class="si">}</span><span class="s2"> following cell</span><span class="si">{</span><span class="s1">&#39;s&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">nf</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2"> of&quot;</span>
            <span class="sa">f</span><span class="s2">&quot; which </span><span class="si">{</span><span class="n">n_empty</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="s1">&#39;are&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">n_empty</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;is&#39;</span><span class="si">}</span><span class="s2"> empty.&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Cells: </span><span class="si">{</span><span class="n">next_cells</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">tot_visited_to_cell_idx</span><span class="p">(</span><span class="n">tot_visited</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">row</span><span class="p">:</span> <span class="n">Row</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Helper to get the correct cell from the row.</span>

<span class="sd">    Notes:</span>
<span class="sd">    pick out next cells corresponding to column j</span>
<span class="sd">    [</span>
<span class="sd">        Cell(name=&quot;&quot;, value=&quot;sourcenotes&quot;, multirow=1, multicolumn=4),</span>
<span class="sd">        EmptyCell(name=)</span>

<span class="sd">    ]</span>
<span class="sd">    Want index map:</span>
<span class="sd">        {0: 0, 1: 0, 2: 0, 3: 0, 4: 1}</span>
<span class="sd">    i.e. first 4 indices maps to the multicolumn cell and the last index</span>
<span class="sd">    maps to the empty cell.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cells</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">cells</span>
    <span class="n">lens</span> <span class="o">=</span> <span class="n">cumsum</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">cells</span><span class="p">])</span>
    <span class="n">idc_pairs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">lens</span><span class="p">,</span> <span class="n">lens</span><span class="p">))</span>
    <span class="n">idx_to_cell_idx</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">i</span><span class="p">:</span> <span class="n">j</span> <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">pair</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cells</span><span class="p">)),</span> <span class="n">idc_pairs</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">*</span><span class="n">pair</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">idx_to_cell_idx</span><span class="p">[</span><span class="n">tot_visited</span><span class="p">]</span>


<span class="k">def</span><span class="w"> </span><span class="nf">validate_multirow_cell</span><span class="p">(</span>
    <span class="n">cell</span><span class="p">:</span> <span class="n">Cell</span><span class="p">,</span>
    <span class="n">row</span><span class="p">:</span> <span class="n">Row</span><span class="p">,</span>
    <span class="n">rows</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">TableRow</span><span class="p">],</span>
    <span class="n">i</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">j</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">tot_visited</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Validates multirow cell.</span>

<span class="sd">    Args:</span>
<span class="sd">        cell: The cell to validate.</span>
<span class="sd">        row: The row containing the cell.</span>
<span class="sd">        rows: The rows in the table.</span>
<span class="sd">        i: The index of the row.</span>
<span class="sd">        j: The index of the cell in the row.</span>
<span class="sd">        tot_visited: The total length of the row visited so far.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">clen</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">clen</span><span class="p">()</span>
    <span class="n">ni</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">f_rows</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">[</span><span class="n">ni</span> <span class="p">:</span> <span class="n">ni</span> <span class="o">+</span> <span class="n">clen</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="p">(</span><span class="n">Row</span><span class="p">,</span> <span class="n">Cmidrule</span><span class="p">,</span> <span class="n">Cmidrules</span><span class="p">))</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">f_rows</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;Row with multirow cell must be followed by &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;rows with empty cells. Found </span><span class="si">{</span><span class="n">f_rows</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="n">next_cells</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">f_rows</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">Row</span><span class="p">):</span>
            <span class="c1"># pick out cell from correct column if e.g. multicolumns</span>
            <span class="n">next_cells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">cells</span><span class="p">[</span><span class="n">tot_visited_to_cell_idx</span><span class="p">(</span><span class="n">tot_visited</span><span class="p">,</span> <span class="n">f</span><span class="p">)])</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">Cmidrule</span><span class="p">,</span> <span class="n">Cmidrules</span><span class="p">)):</span>
            <span class="n">next_cells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">MrEmptyCell</span><span class="p">())</span>
    <span class="n">validate_next_cells_mr</span><span class="p">(</span><span class="n">next_cells</span><span class="p">,</span> <span class="n">clen</span><span class="p">)</span>

    <span class="c1"># cast to multirowcell and link trailing emptycells</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">MultirowCell</span><span class="p">):</span>
        <span class="n">cell</span> <span class="o">=</span> <span class="n">MultirowCell</span><span class="o">.</span><span class="n">from_cell</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">ncell</span><span class="p">,</span> <span class="n">f_row</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">next_cells</span><span class="p">,</span> <span class="n">f_rows</span><span class="p">):</span>
        <span class="c1"># Need to link empty cells to multirow</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ncell</span><span class="p">,</span> <span class="n">MrEmptyCell</span><span class="p">):</span>
            <span class="n">ncell</span> <span class="o">=</span> <span class="n">MrEmptyCell</span><span class="p">()</span>
            <span class="n">ncell</span><span class="o">.</span><span class="n">link</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ncell</span><span class="o">.</span><span class="n">mr</span> <span class="ow">is</span> <span class="n">cell</span><span class="p">:</span>
            <span class="c1"># ncell not linked to multirow; link it</span>
            <span class="n">ncell</span><span class="o">.</span><span class="n">link</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">f_row</span><span class="p">,</span> <span class="n">Row</span><span class="p">):</span>
            <span class="c1"># insert linked cell in row; don&#39;t do it for Cmidrule(s)</span>
            <span class="c1"># insert at correct `tot_visited` place; not just `j` for</span>
            <span class="c1"># the #element in the row</span>
            <span class="n">f_row</span><span class="p">[</span><span class="n">tot_visited_to_cell_idx</span><span class="p">(</span><span class="n">tot_visited</span><span class="p">,</span> <span class="n">f_row</span><span class="p">)]</span> <span class="o">=</span> <span class="n">ncell</span>
    <span class="c1"># insert multirowcell in row</span>
    <span class="n">row</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">cell</span>


<span class="k">def</span><span class="w"> </span><span class="nf">validate_column_rows</span><span class="p">(</span><span class="n">rows</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">TableRow</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Validates rows in a single column.</span>

<span class="sd">    I.e. all rows have one TableRow element.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">rows</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">Row</span><span class="p">):</span>
            <span class="n">tot_visited</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">cell</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">cells</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">cell</span><span class="o">.</span><span class="n">is_multirow</span><span class="p">():</span>
                    <span class="n">validate_multirow_cell</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">rows</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">tot_visited</span><span class="p">)</span>
                <span class="n">tot_visited</span> <span class="o">+=</span> <span class="n">cell</span><span class="o">.</span><span class="fm">__len__</span><span class="p">()</span>  <span class="c1"># e.g. multicolumn cell</span>


<span class="k">def</span><span class="w"> </span><span class="nf">render_body</span><span class="p">(</span>
    <span class="n">body</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">align</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">align</span><span class="p">:</span>
        <span class="n">align</span> <span class="o">=</span> <span class="s2">&quot;@</span><span class="si">{}</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;c&quot;</span> <span class="o">*</span> <span class="n">n</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">@&quot;</span>
    <span class="n">body</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;  &quot;</span> <span class="o">+</span> <span class="n">line</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">body</span><span class="o">.</span><span class="n">splitlines</span><span class="p">())</span>
    <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="sa">r</span><span class="s2">&quot;\begin</span><span class="si">{tabular}</span><span class="s2">{@</span><span class="si">{}</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">align</span> <span class="o">+</span> <span class="s2">&quot;@</span><span class="si">{}</span><span class="s2">}&quot;</span><span class="p">,</span>
            <span class="sa">r</span><span class="s2">&quot;  \toprule&quot;</span><span class="p">,</span>
            <span class="n">body</span><span class="p">,</span>
            <span class="sa">r</span><span class="s2">&quot;  \bottomrule&quot;</span><span class="p">,</span>
            <span class="sa">r</span><span class="s2">&quot;\end</span><span class="si">{tabular}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="p">]</span>
    <span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">check_cmidrule</span><span class="p">(</span><span class="n">cmidrule</span><span class="p">:</span> <span class="n">Cmidrule</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">cmidrule</span><span class="o">.</span><span class="n">end</span> <span class="o">&gt;</span> <span class="n">n</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Cmidrule end (</span><span class="si">{</span><span class="n">cmidrule</span><span class="o">.</span><span class="n">end</span><span class="si">}</span><span class="s2">) must be less than or equal to &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;number of columns (</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">)&quot;</span>
        <span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">validate_cmidrules</span><span class="p">(</span><span class="n">columns</span><span class="p">:</span> <span class="n">Columns</span><span class="p">):</span>
    <span class="c1"># Check cmidrules are within table</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">columns</span><span class="o">.</span><span class="n">all_rows</span><span class="p">():</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">Cmidrule</span><span class="p">):</span>
            <span class="n">check_cmidrule</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">columns</span><span class="o">.</span><span class="n">ncols</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">Cmidrules</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">cmidrule</span> <span class="ow">in</span> <span class="n">row</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
                <span class="n">check_cmidrule</span><span class="p">(</span><span class="n">cmidrule</span><span class="p">,</span> <span class="n">columns</span><span class="o">.</span><span class="n">ncols</span><span class="p">)</span>


<div class="viewcode-block" id="empty_cell">
<a class="viewcode-back" href="../../apidocs/tabx/tabx.table.html#tabx.table.empty_cell">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">empty_cell</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Cell</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create an empty `Cell`.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Cell</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span></div>



<div class="viewcode-block" id="empty_cells">
<a class="viewcode-back" href="../../apidocs/tabx/tabx.table.html#tabx.table.empty_cells">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">empty_cells</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Cell</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a list of `n` empty `Cell` objects.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">empty_cell</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span></div>



<span class="k">def</span><span class="w"> </span><span class="nf">cumsum</span><span class="p">(</span><span class="n">lst</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return cumulative sum of a list.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">it</span><span class="o">.</span><span class="n">accumulate</span><span class="p">(</span><span class="n">lst</span><span class="p">))</span>


<span class="n">T</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;T&quot;</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">flatten</span><span class="p">(</span><span class="n">lst</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="n">T</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Flatten a list of lists.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">it</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">lst</span><span class="p">))</span>


<span class="k">def</span><span class="w"> </span><span class="nf">cmidrules_ns</span><span class="p">(</span><span class="n">all_cols</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Columns</span> <span class="o">|</span> <span class="n">Column</span><span class="p">]):</span>
    <span class="n">all_n</span> <span class="o">=</span> <span class="n">cumsum</span><span class="p">([</span><span class="n">c</span><span class="o">.</span><span class="n">ncols</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">all_cols</span><span class="p">])</span>
    <span class="k">return</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">all_n</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>  <span class="c1"># First col shouldn&#39;t be displaced</span>


<span class="k">def</span><span class="w"> </span><span class="nf">update_cmidrules</span><span class="p">(</span>
    <span class="n">cmidrules</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Cmidrule</span><span class="p">]],</span>
    <span class="n">cmid_ns</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Cmidrules</span><span class="p">:</span>
    <span class="n">ncmidrules</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Cmidrule</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">cmidrule</span> <span class="ow">in</span> <span class="n">cmidrules</span><span class="p">:</span>
        <span class="n">cmidrule</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">cmidrule</span><span class="p">)</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">cmidrule</span><span class="o">.</span><span class="n">dlen</span><span class="p">()</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">cmid_ns</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
        <span class="n">new_start</span> <span class="o">=</span> <span class="n">cmidrule</span><span class="o">.</span><span class="n">start</span> <span class="o">+</span> <span class="n">n</span>
        <span class="n">cmidrule</span><span class="o">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">new_start</span>
        <span class="n">cmidrule</span><span class="o">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">new_start</span> <span class="o">+</span> <span class="n">d</span>
        <span class="n">ncmidrules</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cmidrule</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Cmidrules</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="n">ncmidrules</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">check_empty_cells</span><span class="p">(</span><span class="n">rows</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">TableRow</span><span class="p">]):</span>
    <span class="n">cells</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">f</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span>
            <span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">cells</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">Row</span><span class="p">)]</span>
        <span class="p">)</span>
    <span class="p">]</span>
    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span><span class="ow">not</span> <span class="n">f</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">cells</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">join_rows</span><span class="p">(</span><span class="n">all_cols</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Columns</span><span class="p">]):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">Columns</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">all_cols</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;All columns must be Columns objects; got </span><span class="si">{</span><span class="p">[</span><span class="nb">type</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">all_cols</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">r</span> <span class="o">:=</span> <span class="nb">set</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">ncols</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">all_cols</span><span class="p">))</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;All columns must have same number of columns to join rows. Found: </span><span class="si">{</span><span class="n">r</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
    <span class="n">new_rows</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">all_cols</span><span class="p">:</span>
        <span class="n">new_rows</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">col</span><span class="o">.</span><span class="n">all_rows</span><span class="p">())</span>
    <span class="n">align</span> <span class="o">=</span> <span class="n">all_cols</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">align</span>
    <span class="k">return</span> <span class="n">Columns</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="n">new_rows</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="n">align</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">join_columns</span><span class="p">(</span><span class="n">all_cols</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Columns</span> <span class="o">|</span> <span class="n">Column</span><span class="p">]):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">Columns</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">all_cols</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;All columns must be Columns objects; got </span><span class="si">{</span><span class="p">[</span><span class="nb">type</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">all_cols</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">r</span> <span class="o">:=</span> <span class="nb">set</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">total_rows</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">all_cols</span><span class="p">))</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;All columns must have same number of rows. Found: </span><span class="si">{</span><span class="nb">sorted</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
    <span class="n">all_cols</span> <span class="o">=</span> <span class="p">[</span>
        <span class="c1"># e.g. when concatenating same column multiple times with multirow</span>
        <span class="c1"># inside we need to deepcopy object for linking to work</span>
        <span class="n">deepcopy</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">all_cols</span>
    <span class="p">]</span>
    <span class="n">new_rows</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">new_n</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">c</span><span class="o">.</span><span class="n">ncols</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">all_cols</span><span class="p">])</span>
    <span class="n">cmid_ns</span> <span class="o">=</span> <span class="n">cmidrules_ns</span><span class="p">(</span><span class="n">all_cols</span><span class="p">)</span>
    <span class="n">new_align</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">c</span><span class="o">.</span><span class="n">align</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">all_cols</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">all_rows</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">all_cols</span><span class="p">],</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">)):</span>
        <span class="k">match</span> <span class="n">group</span><span class="p">:</span>
            <span class="k">case</span> <span class="p">[</span><span class="o">*</span><span class="n">rows</span><span class="p">]</span> <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Row</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">):</span>
                <span class="n">rows</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="nb">list</span><span class="p">[</span><span class="n">Row</span><span class="p">],</span> <span class="n">rows</span><span class="p">)</span>
                <span class="n">new_row</span> <span class="o">=</span> <span class="n">Row</span><span class="p">(</span>
                    <span class="n">cells</span><span class="o">=</span><span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">([</span><span class="n">row</span><span class="o">.</span><span class="n">cells</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">])]</span>
                <span class="p">)</span>
                <span class="n">new_rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_row</span><span class="p">)</span>
            <span class="k">case</span> <span class="p">[</span><span class="o">*</span><span class="n">rows</span><span class="p">]</span> <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Cmidrule</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">):</span>
                <span class="n">rows</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="nb">list</span><span class="p">[</span><span class="n">Cmidrule</span><span class="p">],</span> <span class="n">rows</span><span class="p">)</span>
                <span class="n">new_cmidrule</span> <span class="o">=</span> <span class="n">update_cmidrules</span><span class="p">(</span>
                    <span class="p">[(</span><span class="n">j</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">rows</span><span class="p">)],</span>
                    <span class="n">cmid_ns</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">new_rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_cmidrule</span><span class="p">)</span>
            <span class="k">case</span> <span class="p">[</span><span class="o">*</span><span class="n">rows</span><span class="p">]</span> <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">Cmidrule</span><span class="p">,</span> <span class="n">Row</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">):</span>
                <span class="c1"># Cmidrules and rows; assert cells empty and return cmidrules</span>
                <span class="c1"># Also have to update cmidrule start and end</span>
                <span class="n">rows</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="nb">list</span><span class="p">[</span><span class="n">TableRow</span><span class="p">],</span> <span class="n">rows</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">check_empty_cells</span><span class="p">(</span><span class="n">rows</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="s2">&quot;Row cells must be empty when mixing Cmidrule and Row&quot;</span>
                    <span class="p">)</span>
                <span class="n">new_cmidrule</span> <span class="o">=</span> <span class="n">update_cmidrules</span><span class="p">(</span>
                    <span class="p">[(</span><span class="n">j</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">Cmidrule</span><span class="p">)],</span>
                    <span class="n">cmid_ns</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">new_rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_cmidrule</span><span class="p">)</span>
            <span class="k">case</span> <span class="p">[</span><span class="o">*</span><span class="n">rows</span><span class="p">]</span> <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ColoredRow</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">):</span>
                <span class="n">rows</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="nb">list</span><span class="p">[</span><span class="n">ColoredRow</span><span class="p">],</span> <span class="n">rows</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot have multiple ColoredRows in same row.&quot;</span><span class="p">)</span>
                <span class="p">(</span><span class="n">row</span><span class="p">,)</span> <span class="o">=</span> <span class="n">rows</span>
                <span class="n">new_rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
            <span class="k">case</span> <span class="p">[</span><span class="o">*</span><span class="n">rows</span><span class="p">]</span> <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Midrule</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">):</span>
                <span class="n">new_rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Midrule</span><span class="p">())</span>
            <span class="k">case</span> <span class="p">[</span><span class="o">*</span><span class="n">rows</span><span class="p">]</span> <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Rule</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">):</span>
                <span class="n">is_color</span> <span class="o">=</span> <span class="nb">any</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ColoredRow</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">])</span>
                <span class="n">is_midrule</span> <span class="o">=</span> <span class="nb">any</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Midrule</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">is_color</span> <span class="ow">and</span> <span class="n">is_midrule</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot mix ColoredRow and Midrule in same row.&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">is_midrule</span><span class="p">:</span>
                    <span class="n">new_rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Midrule</span><span class="p">())</span>
            <span class="k">case</span> <span class="p">[</span><span class="o">*</span><span class="n">rows</span><span class="p">]</span> <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">Row</span><span class="p">,</span> <span class="n">Rule</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">):</span>
                <span class="n">rows</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="nb">list</span><span class="p">[</span><span class="n">TableRow</span><span class="p">],</span> <span class="n">rows</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">check_empty_cells</span><span class="p">(</span><span class="n">rows</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="s2">&quot;Row cells must be empty when mixing Midrule and Row&quot;</span>
                    <span class="p">)</span>
                <span class="n">rows_rule</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">rows</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">Rule</span><span class="p">)]</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rows_rule</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="p">(</span><span class="n">rule</span><span class="p">,)</span> <span class="o">=</span> <span class="n">rows_rule</span>
                    <span class="n">new_rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rule</span><span class="p">)</span>
            <span class="k">case</span> <span class="p">[</span><span class="o">*</span><span class="n">rows</span><span class="p">]</span> <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">Cmidrules</span><span class="p">,</span> <span class="n">Row</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">):</span>
                <span class="c1"># Same as for single cmidrule</span>
                <span class="n">rows</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="nb">list</span><span class="p">[</span><span class="n">TableRow</span><span class="p">],</span> <span class="n">rows</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">check_empty_cells</span><span class="p">(</span><span class="n">rows</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="s2">&quot;Row cells must be empty when mixing Cmidrules and Row&quot;</span>
                    <span class="p">)</span>
                <span class="n">all_cmids</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">rows</span><span class="p">):</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">Cmidrules</span><span class="p">):</span>
                        <span class="k">for</span> <span class="n">cmid</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
                            <span class="c1"># idx j for correct displacement</span>
                            <span class="c1"># if multiple cmidrules they need same displacement</span>
                            <span class="c1"># based on the Columns object they came from.</span>
                            <span class="n">all_cmids</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">j</span><span class="p">,</span> <span class="n">cmid</span><span class="p">))</span>
                <span class="n">new_cmidrule</span> <span class="o">=</span> <span class="n">update_cmidrules</span><span class="p">(</span><span class="n">all_cmids</span><span class="p">,</span> <span class="n">cmid_ns</span><span class="p">)</span>
                <span class="n">new_rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_cmidrule</span><span class="p">)</span>
            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;All rows must be of same type (Row or Cmidrule)&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Columns</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="n">new_rows</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="n">new_align</span><span class="p">)</span>


<div class="viewcode-block" id="concat">
<a class="viewcode-back" href="../../apidocs/tabx/tabx.table.html#tabx.table.concat">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">concat</span><span class="p">(</span>
    <span class="n">tables</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Table</span><span class="p">],</span>
    <span class="n">how</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;vertical&quot;</span><span class="p">,</span> <span class="s2">&quot;horizontal&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;vertical&quot;</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Concatenates tables.</span>

<span class="sd">    :param tables: List of `Table` objects to concatenate.</span>
<span class="sd">    :param how: How to concatenate the tables.</span>
<span class="sd">    :return: A new `Table` object with the concatenated rows or columns.</span>

<span class="sd">    See also the operator overloading syntax.</span>

<span class="sd">    ```python</span>
<span class="sd">    import tabx</span>
<span class="sd">    from tabx import Table</span>
<span class="sd">    table1 = Table.from_values([[1, 2], [3, 4]])</span>
<span class="sd">    table2 = Table.from_values([[5, 6], [7, 8]])</span>
<span class="sd">    tabx.concat([table1, table2], how=&quot;horizontal&quot;) == table1 | table2</span>
<span class="sd">    # True</span>
<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">match</span> <span class="n">how</span><span class="p">:</span>
        <span class="k">case</span> <span class="s2">&quot;vertical&quot;</span><span class="p">:</span>
            <span class="c1"># Concatenate rows</span>
            <span class="n">new_cols</span> <span class="o">=</span> <span class="n">join_rows</span><span class="p">([</span><span class="n">t</span><span class="o">.</span><span class="n">columns</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">tables</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">Table</span><span class="o">.</span><span class="n">from_columns</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">new_cols</span><span class="p">)</span>
        <span class="k">case</span> <span class="s2">&quot;horizontal&quot;</span><span class="p">:</span>
            <span class="c1"># Concatenate columns</span>
            <span class="n">new_cols</span> <span class="o">=</span> <span class="n">join_columns</span><span class="p">([</span><span class="n">t</span><span class="o">.</span><span class="n">columns</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">tables</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">Table</span><span class="o">.</span><span class="n">from_columns</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">new_cols</span><span class="p">)</span>
        <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid </span><span class="si">{</span><span class="n">how</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span></div>

</pre></div>
        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, jsr-p
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer no-toc">
      
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    </body>
</html>